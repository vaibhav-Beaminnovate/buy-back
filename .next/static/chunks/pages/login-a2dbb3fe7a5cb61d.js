(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{2070:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return n(1796)}])},1796:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var r=n(5893),a=n(7294),s=n(9412),o=n(1163),l=n(8386),i=n(9134),c=()=>{let e="https://buybackservice.unicornstore.in",[t,n]=(0,a.useState)(!1),[c,u]=(0,a.useState)(""),d=(0,o.useRouter)(),[m,p]=(0,a.useState)({username:"",password:""}),[f,h]=(0,a.useState)({username:"",password:""}),[g,b]=(0,a.useState)("username"),[x,v]=(0,a.useState)(""),[w,y]=(0,a.useState)(!1),[j,N]=(0,a.useState)(0),[S,k]=(0,a.useState)(""),[_,P]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("name");e&&t&&d.replace("/")},[d]);let E=e=>{let{name:t,value:n}=e.target;p({...m,[t]:n}),"phone"===g&&y(!1),h(e=>{let r={...e};return"username"===t&&(n.trim()?"phone"===g&&10!==n.length?r.username="Phone number must be 10 digits":r.username="":r.username="".concat("username"===g?"Username":"Phone number"," is required")),"password"===t&&(n.trim()?r.password="":r.password="Password is required"),r})},C=()=>{let e={};return m.username.trim()||(e.username="".concat("username"===g?"Username":"Phone number"," is required")),"phone"===g&&10!==m.username.length&&(e.username="Phone number must be 10 digits"),"username"!==g||m.password.trim()||(e.password="Password is required"),"phone"===g&&w&&!x.trim()&&(e.password="OTP is required"),h(e),0===Object.keys(e).length},I=async t=>{if(t.preventDefault(),C())try{P(!0),u(null);let t=new FormData;t.append("username",m.username),t.append("password",m.password);let n=await fetch("".concat(e,"/staff/token"),{method:"POST",body:t});if(!n.ok)throw Error("Could not get token");let r=await n.json();if("success"!==r.status)throw Error(r.message);localStorage.setItem("token",r.access_token),localStorage.setItem("name",r.name),localStorage.setItem("staff_id",r.staff_id),localStorage.setItem("staff_login",r.staff_login),d.replace("/")}catch(e){console.error(e.message),u("Something went wrong: ".concat(e.message)),i.Am.error(e.message)}finally{P(!1)}},O=async t=>{if(t.preventDefault(),C()){if(!w){D();return}try{P(!0),u(null);let t=await fetch("".concat(e,"/confirm_executive_otp"),{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({otp:x,executive_id:S,otp_for:"executive_log"})});if(!t.ok)throw Error("Could not confirm OTP");let n=await t.json();if("success"!==n.status)throw Error(n.message);localStorage.setItem("token",n.access_token),localStorage.setItem("name",n.name),localStorage.setItem("staff_id",n.staff_id),localStorage.setItem("staff_login",n.staff_login),localStorage.setItem("executive_id",n.executive_id),d.replace("/")}catch(e){u("Something went wrong: ".concat(e.message)),i.Am.error(e.message)}finally{P(!1)}}},D=async()=>{try{P(!0);let t=await fetch("".concat(e,"/send-opt-to-executive/"),{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({number:m.username,otp_for:"executive_log"})});if(!t.ok)throw Error("Could not send OTP");let n=await t.json();if("success"!==n.status)throw Error(n.message);k(n.executive_id)}catch(e){i.Am.error(e.message)}finally{P(!1),y(!0),N(60)}},T=async()=>{T>0||D()};return(0,a.useEffect)(()=>{let e;return j>0&&(e=setInterval(()=>{N(e=>e-1)},1e3)),()=>clearInterval(e)},[j]),(0,r.jsx)("div",{className:"flex items-center justify-center py-20 bg-white",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-center mb-6",children:"Store Login"}),"username"===g&&(0,r.jsxs)("form",{onSubmit:e=>I(e),children:[(0,r.jsxs)("div",{className:"mb-6 relative",children:[(0,r.jsx)("label",{htmlFor:"username",className:"block text-gray-700 mb-0.5",children:"Username or Email Address"}),(0,r.jsx)("input",{type:"text",id:"username",name:"username",value:m.username,onChange:e=>E(e),className:"w-full p-3 border border-gray-300 rounded-lg ring-accent ".concat(f.username?"border-red-300":""),placeholder:"Enter username or email",autoComplete:"email"}),f.username&&(0,r.jsx)("span",{className:"text-red-500 text-xs absolute left-0 -bottom-5",children:f.username})]}),(0,r.jsxs)("div",{className:"mb-6 relative",children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-gray-700 mb-0.5",children:"Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:t?"text":"password",id:"password",name:"password",value:m.password,onChange:e=>E(e),className:"w-full p-3 border border-gray-300 rounded-lg ring-accent ".concat(f.password?"border-red-300":""),placeholder:"Enter password",autoComplete:"current-password"}),(0,r.jsx)("span",{tabIndex:0,className:"absolute inset-y-0 text-gray-500 cursor-pointer content-center right-0 pe-3 ps-3 rounded-e-lg hover:bg-gray-100 hover:bg-opacity-50 focus:bg-gray-200 focus:bg-opacity-50 outline-none",onClick:()=>{n(e=>!e)},children:(0,r.jsx)("i",{className:"bi ".concat(t?"bi-eye-slash":"bi-eye")})})]}),f.password&&(0,r.jsx)("span",{className:"text-red-500 text-xs absolute left-0 -bottom-5",children:f.password})]}),c&&(0,r.jsx)("p",{className:"text-red-500 text-sm mb-4",children:c}),(0,r.jsx)(s.A,{isLoading:_,type:"submit",className:"w-full bg-accent text-white p-3 rounded-lg transition duration-300",children:"Login"})]}),"phone"===g&&(0,r.jsxs)("form",{onSubmit:e=>O(e),children:[(0,r.jsxs)("div",{className:"mb-4 relative",children:[(0,r.jsx)("label",{htmlFor:"username",className:"block text-gray-700 mb-2",children:"Phone Number"}),(0,r.jsx)("input",{type:"number",id:"username",name:"username",value:m.username,onChange:e=>E(e),className:"w-full p-3 border border-gray-300 rounded-lg ring-accent ".concat(f.username?"border-red-300":""),placeholder:"Enter your phone number",autoComplete:"tel"}),f.username&&(0,r.jsx)("span",{className:"text-red-500 text-xs",children:f.username})]}),(0,r.jsxs)("div",{className:"mb-4 relative",children:[(0,r.jsx)("label",{htmlFor:"OTP",className:"block text-gray-700 mb-2",children:"OTP"}),(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(l.Z,{id:"OTP",value:x,onChange:v,numInputs:6,renderSeparator:(0,r.jsx)("span",{children:"\xa0"}),inputStyle:"border rounded p-0.5 w-8 outline-none",renderInput:e=>(0,r.jsx)("input",{...e})})}),f.password&&(0,r.jsx)("span",{className:"text-red-500 text-xs",children:f.password})]}),c&&(0,r.jsx)("p",{className:"text-red-500 text-sm mb-4",children:c}),(0,r.jsx)(s.A,{isLoading:_,type:"submit",className:"w-full bg-accent text-white p-3 rounded-lg transition duration-300 ring-accent",children:w?"Login":"Send OTP"})]}),(0,r.jsxs)("div",{className:"relative flex justify-between mt-4",children:["phone"===g&&w&&(0,r.jsxs)("button",{className:"w-fit block mr-auto accent disabled:text-gray-400",disabled:j>0,onClick:T,children:["Resend OTP ",j>0?"in ".concat(j):""]}),(0,r.jsxs)("button",{className:"w-fit block ml-auto accent cursor-pointer",onClick:()=>{b(e=>"username"===e?"phone":"username"),h({username:"",password:""}),p({username:"",password:""}),v(""),y(!1)},children:["Login with"," ","username"===g?"phone number?":"username?"]})]})]})})},u=n(9008),d=n.n(u),m=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d(),{children:(0,r.jsx)("title",{children:"BuyBack - Login"})}),(0,r.jsx)(c,{})]})},9008:function(e,t,n){e.exports=n(7828)},8386:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(7294),a=function(e){return"object"==typeof e&&null!==e},s=function(e){var t=e.value,n=void 0===t?"":t,s=e.numInputs,o=void 0===s?4:s,l=e.onChange,i=e.onPaste,c=e.renderInput,u=e.shouldAutoFocus,d=void 0!==u&&u,m=e.inputType,p=void 0===m?"text":m,f=e.renderSeparator,h=e.placeholder,g=e.containerStyle,b=e.inputStyle,x=e.skipDefaultStyles,v=void 0!==x&&x,w=r.useState(0),y=w[0],j=w[1],N=r.useRef([]),S=function(){return n?n.toString().split(""):[]},k="number"===p||"tel"===p;r.useEffect(function(){N.current=N.current.slice(0,o)},[o]),r.useEffect(function(){var e;d&&(null===(e=N.current[0])||void 0===e||e.focus())},[d]);var _=function(){if("string"==typeof h){if(h.length===o)return h;h.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}},P=function(e){return(k?!isNaN(Number(e)):"string"==typeof e)&&1===e.trim().length},E=function(e){var t=e.target.value;P(t)&&(T(t),D(y+1))},C=function(e){var t=e.nativeEvent,n=e.target.value;P(n)||(n.length!==o||n.split("").some(function(e){return!P(e)})||(A(n.split("")),D(o-1)),null===t.data&&"deleteContentBackward"===t.inputType&&(e.preventDefault(),T(""),D(y-1)),e.target.value="")},I=function(){j(y-1)},O=function(e){var t=S();[e.code,e.key].includes("Backspace")?(e.preventDefault(),T(""),D(y-1)):"Delete"===e.code?(e.preventDefault(),T("")):"ArrowLeft"===e.code?(e.preventDefault(),D(y-1)):"ArrowRight"===e.code?(e.preventDefault(),D(y+1)):e.key===t[y]?(e.preventDefault(),D(y+1)):("Spacebar"===e.code||"Space"===e.code||"ArrowUp"===e.code||"ArrowDown"===e.code)&&e.preventDefault()},D=function(e){var t,n,r=Math.max(Math.min(o-1,e),0);N.current[r]&&(null===(t=N.current[r])||void 0===t||t.focus(),null===(n=N.current[r])||void 0===n||n.select(),j(r))},T=function(e){var t=S();t[y]=e[0],A(t)},A=function(e){l(e.join(""))},F=function(e){e.preventDefault();var t,n=S(),r=y,a=e.clipboardData.getData("text/plain").slice(0,o-y).split("");if(!(k&&a.some(function(e){return isNaN(Number(e))}))){for(var s=0;s<o;++s)s>=y&&a.length>0&&(n[s]=null!==(t=a.shift())&&void 0!==t?t:"",r++);D(r),A(n)}};return r.createElement("div",{style:Object.assign({display:"flex",alignItems:"center"},a(g)&&g),className:"string"==typeof g?g:void 0,onPaste:i},Array.from({length:o},function(e,t){return t}).map(function(e){var t,n,s;return r.createElement(r.Fragment,{key:e},c({value:null!==(t=S()[e])&&void 0!==t?t:"",placeholder:null!==(s=null===(n=_())||void 0===n?void 0:n[e])&&void 0!==s?s:void 0,ref:function(t){return N.current[e]=t},onChange:E,onFocus:function(t){j(e),t.target.select()},onBlur:I,onKeyDown:O,onPaste:F,autoComplete:"off","aria-label":"Please enter OTP character ".concat(e+1),style:Object.assign(v?{}:{width:"1em",textAlign:"center"},a(b)?b:{}),className:"string"==typeof b?b:void 0,type:p,inputMode:k?"numeric":"text",onInput:C},e),e<o-1&&("function"==typeof f?f(e):f))}))}}},function(e){e.O(0,[23,136,835,562,888,774,179],function(){return e(e.s=2070)}),_N_E=e.O()}]);