(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[868],{1603:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/warehouse/login",function(){return t(2383)}])},2383:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var r=t(5893),a=t(9412),n=t(1163),o=t(7294),l=t(9134),i=t(8386),c=()=>{let e="https://buybackservice.unicornstore.in",[s,t]=(0,o.useState)(!1),[c,u]=(0,o.useState)(""),d=(0,n.useRouter)(),[m,h]=(0,o.useState)({username:"",password:""}),[p,w]=(0,o.useState)({username:"",password:""}),[x,b]=(0,o.useState)("username"),[g,f]=(0,o.useState)(""),[y,j]=(0,o.useState)(!1),[v,N]=(0,o.useState)(0),[_,S]=(0,o.useState)(""),[k,P]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=localStorage.getItem("warehouse_token"),s=localStorage.getItem("warehouse_name");e&&s&&d.replace("/warehouse")},[d]);let E=e=>{let{name:s,value:t}=e.target;h({...m,[s]:t}),"phone"===x&&j(!1),w(e=>{let r={...e};return"username"===s&&(t.trim()?"phone"===x&&10!==t.length?r.username="Phone number must be 10 digits":r.username="":r.username="".concat("username"===x?"Username":"Phone number"," is required")),"password"===s&&(t.trim()?r.password="":r.password="Password is required"),r})},O=()=>{let e={};return m.username.trim()||(e.username="".concat("username"===x?"Username":"Phone number"," is required")),"phone"===x&&10!==m.username.length&&(e.username="Phone number must be 10 digits"),"username"!==x||m.password.trim()||(e.password="Password is required"),"phone"===x&&y&&!g.trim()&&(e.password="OTP is required"),w(e),0===Object.keys(e).length},C=async s=>{if(s.preventDefault(),O())try{P(!0);let s=new FormData;s.append("username",m.username),s.append("password",m.password);let t=await fetch("".concat(e,"/warehouse/token"),{method:"POST",body:s});if(!t.ok){u("Invalid username or password");return}let r=await t.json();localStorage.setItem("warehouse_token",r.access_token),localStorage.setItem("warehouse_name",r.name),localStorage.setItem("warehouse_id",r.warehouse_id),d.push("/warehouse/shipments")}catch(e){l.Am.error(e.message,{toastId:"warhouseLoginError"})}finally{P(!1)}},I=async s=>{if(s.preventDefault(),O()){if(!y){T();return}try{P(!0),u(null);let s=await fetch("".concat(e,"/confirm_executive_otp"),{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({otp:g,executive_id:_,otp_for:"executive_log"})});if(!s.ok)throw Error("Could not confirm OTP");let t=await s.json();if("success"!==t.status)throw Error(t.message);localStorage.setItem("warehouse_token",t.access_token),localStorage.setItem("warehouse_name",t.name),localStorage.setItem("warehouse_id",t.warehouse_id),d.replace("/warehouse")}catch(e){u("Something went wrong: ".concat(e.message)),l.Am.error(e.message)}finally{P(!1)}}},T=async()=>{try{P(!0);let s=await fetch("".concat(e,"/send-opt-to-executive/"),{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({number:m.username,otp_for:"executive_log"})});if(!s.ok)throw Error("Could not send OTP");let t=await s.json();if("success"!==t.status)throw Error(t.message);S(t.executive_id)}catch(e){l.Am.error(e.message)}finally{P(!1),j(!0),N(60)}},A=async()=>{A>0||T()};return(0,o.useEffect)(()=>{let e;return v>0&&(e=setInterval(()=>{N(e=>e-1)},1e3)),()=>clearInterval(e)},[v]),(0,r.jsx)("div",{className:"flex items-center justify-center py-20 mt-24",children:(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-center mb-6",children:"Warehouse Login"}),"username"===x&&(0,r.jsxs)("form",{onSubmit:e=>C(e),children:[(0,r.jsxs)("div",{className:"mb-6 relative",children:[(0,r.jsx)("label",{htmlFor:"username",className:"block text-gray-700 mb-0.5",children:"Username or Email Address"}),(0,r.jsx)("input",{type:"text",id:"username",name:"username",value:m.username,onChange:e=>E(e),className:"w-full p-3 border border-gray-300 rounded-lg ring-accent ".concat(p.username?"border-red-300":""),placeholder:"Enter username or email",autoComplete:"email"}),p.username&&(0,r.jsx)("span",{className:"text-red-500 text-xs absolute left-0 -bottom-5",children:p.username})]}),(0,r.jsxs)("div",{className:"mb-6 relative",children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-gray-700 mb-0.5",children:"Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:s?"text":"password",id:"password",name:"password",value:m.password,onChange:e=>E(e),className:"w-full p-3 border border-gray-300 rounded-lg ring-accent ".concat(p.password?"border-red-300":""),placeholder:"Enter password",autoComplete:"current-password"}),(0,r.jsx)("span",{tabIndex:0,className:"absolute inset-y-0 text-gray-500 cursor-pointer content-center right-0 pe-3 ps-3 rounded-e-lg hover:bg-gray-100 hover:bg-opacity-50 focus:bg-gray-200 focus:bg-opacity-50 outline-none",onClick:()=>{t(e=>!e)},children:(0,r.jsx)("i",{className:"bi ".concat(s?"bi-eye-slash":"bi-eye")})})]}),p.password&&(0,r.jsx)("span",{className:"text-red-500 text-xs absolute left-0 -bottom-5",children:p.password})]}),c&&(0,r.jsx)("p",{className:"text-red-500 text-sm mb-4",children:c}),(0,r.jsx)(a.A,{isLoading:k,type:"submit",className:"w-full bg-accent text-white p-3 rounded-lg transition duration-300",children:"Login"})]}),"phone"===x&&(0,r.jsxs)("form",{onSubmit:e=>I(e),children:[(0,r.jsxs)("div",{className:"mb-4 relative",children:[(0,r.jsx)("label",{htmlFor:"username",className:"block text-gray-700 mb-2",children:"Phone Number"}),(0,r.jsx)("input",{type:"number",id:"username",name:"username",value:m.username,onChange:e=>E(e),className:"w-full p-3 border border-gray-300 rounded-lg ring-accent ".concat(p.username?"border-red-300":""),placeholder:"Enter your phone number",autoComplete:"tel"}),p.username&&(0,r.jsx)("span",{className:"text-red-500 text-xs",children:p.username})]}),(0,r.jsxs)("div",{className:"mb-4 relative",children:[(0,r.jsx)("label",{htmlFor:"OTP",className:"block text-gray-700 mb-2",children:"OTP"}),(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(i.Z,{id:"OTP",value:g,onChange:f,numInputs:6,renderSeparator:(0,r.jsx)("span",{children:"\xa0"}),inputStyle:"border rounded p-0.5 w-8 outline-none",renderInput:e=>(0,r.jsx)("input",{...e})})}),p.password&&(0,r.jsx)("span",{className:"text-red-500 text-xs",children:p.password})]}),c&&(0,r.jsx)("p",{className:"text-red-500 text-sm mb-4",children:c}),(0,r.jsx)(a.A,{isLoading:k,type:"submit",className:"w-full bg-accent text-white p-3 rounded-lg transition duration-300 ring-accent",children:y?"Login":"Send OTP"})]}),(0,r.jsx)("div",{className:"relative flex justify-between mt-4",children:"phone"===x&&y&&(0,r.jsxs)("button",{className:"w-fit block mr-auto accent disabled:text-gray-400",disabled:v>0,onClick:A,children:["Resend OTP ",v>0?"in ".concat(v):""]})})]})})},u=()=>(0,r.jsx)("div",{children:(0,r.jsx)(c,{})})}},function(e){e.O(0,[888,774,179],function(){return e(e.s=1603)}),_N_E=e.O()}]);