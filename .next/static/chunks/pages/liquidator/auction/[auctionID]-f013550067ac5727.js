(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1053],{3511:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/liquidator/auction/[auctionID]",function(){return t(66795)}])},74133:function(e,s,t){"use strict";var a=t(85893);t(67294);var r=t(44039);s.Z=e=>{let{header:s,...t}=e;return(0,a.jsx)(r.Q,{...t,header:e=>{let{state:{isEnter:t}}=e;return(0,a.jsxs)(a.Fragment,{children:[s,(0,a.jsx)("i",{className:"bi bi-chevron-down ml-auto transition-transform duration-200 ease-out flex items-center ".concat(t&&"rotate-180")})]})},className:"border-b",buttonProps:{className:e=>{let{isEnter:s}=e;return"flex items-center w-full p-4 text-left transition-all duration-200 hover:bg-accent-dimmed ".concat(s&&"bg-[#42c8b725]")}},contentProps:{className:"transition-height duration-200 ease-out"},panelProps:{className:"p-4"}})}},50091:function(e,s,t){"use strict";var a=t(85893),r=t(67294);s.Z=e=>{let{closingTime:s,withColon:t}=e,[n,l]=(0,r.useState)(i(s));function i(e){let s=new Date,t=new Date(e)-s;if(t<=0)return{days:0,hours:0,minutes:0,seconds:0};let a=Math.floor(t/1e3%60).toString().padStart(2,"0"),r=Math.floor(t/6e4%60).toString().padStart(2,"0"),n=Math.floor(t/36e5%24).toString().padStart(2,"0");return{days:Math.floor(t/864e5).toString().padStart(2,"0"),hours:n,minutes:r,seconds:a}}return((0,r.useEffect)(()=>{let e=setInterval(()=>{l(i(s))},1e3);return()=>clearInterval(e)},[s]),0===n.hours&&0===n.minutes&&0===n.minutes&&0===n.seconds)?(0,a.jsx)("span",{children:"Auction Ended"}):!0===t?(0,a.jsxs)("span",{className:"grid grid-cols-4 justify-center gap-y-2 w-96",children:[(0,a.jsxs)("span",{className:"text-center",children:[n.days+":"," "]}),(0,a.jsxs)("span",{className:"text-center",children:[n.hours+":"," "]}),(0,a.jsxs)("span",{className:"text-center",children:[n.minutes+":"," "]}),(0,a.jsx)("span",{className:"text-center",children:n.seconds}),(0,a.jsx)("span",{className:"text-sm text-center text-gray-400",children:"Days"}),(0,a.jsx)("span",{className:"text-sm text-center text-gray-400",children:"Hours"}),(0,a.jsx)("span",{className:"text-sm text-center text-gray-400",children:"Minutes"}),(0,a.jsx)("span",{className:"text-sm text-center text-gray-400",children:"Seconds"})]}):(0,a.jsxs)("span",{children:[n.days>0?n.days+"d":""," ",n.days>0||n.hours>0?n.hours+"h":""," ",n.hours>0||n.minutes>0?n.minutes+"m":""," ",n.minutes>0||n.seconds>0?n.seconds+"s":""]})}},66795:function(e,s,t){"use strict";t.r(s);var a=t(85893),r=t(50091),n=t(25612),l=t(25675),i=t.n(l),c=t(11163),o=t(67294),d=t(9134),m=t(2261),x=t(98918);t(30889),t(21306);var h=t(36656),u=t(41664),g=t.n(u),p=t(32553),j=t(9008),f=t.n(j),y=t(74133),N=t(67957),b=t(34863),w=t(39412),v=t(1773),_=t(91680),S=t(50199),A=t(87740),k=t(86597),E=t(10843),I=t(60189),C=t(96476);s.default=()=>{let e="https://buybackservice.unicornstore.in",s=(0,c.useRouter)(),{auctionID:t}=s.query,[l,u]=(0,o.useState)(""),[j,P]=(0,o.useState)(""),[B,D]=(0,o.useState)({}),[q,T]=(0,o.useState)(!1),[M,F]=(0,o.useState)(!0),[O,L]=(0,o.useState)("None"),[K,Z]=(0,o.useState)(),{balance:z,setBalance:R}=(0,h.K)(),[U,X]=(0,o.useState)([]),[V,W]=(0,o.useState)(!1),[H,J]=(0,o.useState)(""),[Q,G]=(0,o.useState)([]),{isOpen:Y,onOpen:$,onOpenChange:ee}=(0,N.q)(),[es,et]=(0,o.useState)(1),[ea,er]=(0,o.useState)(""),[en,el]=(0,o.useState)(!0),ei=(0,o.useRef)(null),ec=(0,p.dQ)(),eo=async()=>{try{F(!0);let e=new WebSocket("".concat("wss://buybackservice.unicornstore.in","/ws/auction/").concat(t));ei.current=e,e.onmessage=e=>{let s=e.data.trim();try{let e=JSON.parse(s);if(e&&"success"===e.auction_data.status){if(u(e.auction_data.data),Z(e.auction_data.wager_found),X(e.wagers_data.data),!H){var t,a,r,n;J(null==e?void 0:null===(a=e.auction_data)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.lot_id),eh(null==e?void 0:null===(n=e.auction_data)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.lot_id)}}else throw Error("Event stream failed")}catch(e){console.error("Error parsing event data: ",e),d.Am.error(e.message,{toastId:"errorParsingEventData"})}finally{F(!1)}},e.onerror=e=>{console.error("EventSource failed: ",e),d.Am.warn("Failed to get auction updates.",{toastId:"errorMessage"})},e.onclose=()=>{}}catch(e){console.log(e),d.Am.warn(e.message,{toastId:"errorMessage"})}},ed=()=>{ei.current&&ei.current.readyState===WebSocket.OPEN&&(ei.current.close(),console.log("WebSocket closed"))},em=()=>{ed()},ex=async()=>{let s=localStorage.getItem("liquidator_id");try{var a;let r=await fetch("".concat(e,"/get-liquidators-highest-bid?liquidator_id=").concat(s,"&auction_id=").concat(t),{headers:{Authorization:ec}});if(!r.ok)throw Error("Could not get users bids");let n=await r.json();"info"===n.status?L("None"):L(null==n?void 0:null===(a=n.data)||void 0===a?void 0:a.wager_amount)}catch(e){}},eh=async s=>{try{el(!0);let t=await fetch("".concat(e,"/get-all-lot_devices/?page=").concat(es,"&per_page=10&lot_id=").concat(s,"&sort_desc=false"),{headers:{Authorization:ec}});if(!t.ok)throw Error("Could not get lot devices");let a=await t.json();G(a.data),er(Math.ceil(a.count))}catch(e){d.Am.error(e.message)}finally{el(!1)}};(0,o.useEffect)(()=>(t&&(eo(),ex()),window.addEventListener("beforeunload",em),()=>{ed(),window.removeEventListener("beforeunload",em)}),[t,s,s.query]),(0,o.useEffect)(()=>{H&&eh(H)},[es]);let eu=async()=>{if(1!==B[1]){T(!0),d.Am.warn("Please select the checkbox",{toastId:"warnAboutCheckbox"});return}T(!1),"false"===localStorage.getItem("completed_registration")&&d.Am.error("Complete your registration before placing bids",{toastId:"error1"}),W(!0);try{let s=localStorage.getItem("liquidator_id"),a=await fetch("".concat(e,"/create-wager"),{method:"POST",headers:{"Content-type":"application/json",header:{Authorization:ec}},body:JSON.stringify({auction_id:t,liquidator_id:s,wager_amount:j})});if(!a.ok)throw Error("Could not create wager");let r=await a.json();"success"===r.status?(d.Am.success("Bid placed successfully",{toastId:"successBid"}),eo(),ex(),R(r.remaining_balance)):"info"===r.status?d.Am.info(r.message,{toastId:"lessAmountInfo"}):"error"===r.status&&d.Am.error(r.message,{toastId:"error"})}catch(e){console.log(e.message)}W(!1)};return M?(0,a.jsx)("div",{className:"text-center mt-40",children:(0,a.jsx)(b.c,{color:"success"})}):M||l?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(f(),{children:(0,a.jsxs)("title",{children:["BuyBack- Auction - ",t]})}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6 p-6",children:[(0,a.jsxs)("div",{className:"col-span-2 p-6 bg-white shadow-lg rounded-lg h-fit",children:[(0,a.jsx)(n.U,{className:"bg-white shadow-lg rounded-lg",transition:!0,transitionTimeout:250,children:(0,a.jsx)(y.Z,{header:(0,a.jsx)("div",{className:"flex justify-between items-center text-xl font-semibold text-gray-800 cursor-pointer",children:(0,a.jsx)("span",{children:l.auction_name+" Images"})}),children:(0,a.jsx)("div",{className:"w-full flex justify-center p-6",children:(0,a.jsx)(m.tq,{modules:[x.W_],spaceBetween:50,slidesPerView:1,navigation:!0,children:l.images.length>0?l.images.map((e,s)=>(0,a.jsx)(m.o5,{children:(0,a.jsx)("div",{className:"w-full flex justify-center p-6",children:(0,a.jsx)(i(),{className:"rounded-lg max-h-96 object-fit w-auto",src:e.s3_image_url,width:420,height:260,alt:"dummy image"})})},s)):(0,a.jsx)(m.o5,{children:(0,a.jsx)("div",{className:"w-full flex justify-center p-6",children:(0,a.jsx)(i(),{className:"rounded-lg max-h-40 object-contain",src:"/default.webp",width:420,height:260,alt:"dummy image"})})})})})})}),(0,a.jsx)("div",{className:"mt-6 px-6",children:(0,a.jsxs)("div",{className:"text-2xl font-bold text-accent flex justify-between items-center",children:[(0,a.jsx)("p",{children:l.auction_name}),(0,a.jsx)(w.A,{color:"success",onPress:$,className:"text-white rounded",children:"Show Devices"})]})}),(0,a.jsxs)("div",{className:"mt-6 px-6 py-4 rounded-lg bg-gray-100",children:[(0,a.jsxs)("div",{className:"border-b-2 border-gray-200 pb-4 flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Time Left:"}),(0,a.jsx)("span",{className:"ml-10 text-4xl font-light text-gray-800",children:(0,a.jsx)(r.Z,{closingTime:l.closing_time,withColon:!0})})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-4 ml-[135px]",children:["Ending at"," ",new Date(l.closing_time).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})]})]}),(0,a.jsx)("div",{className:"pt-4 flex flex-col",children:K?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Current Bid:"}),(0,a.jsx)("span",{className:"ml-10 text-3xl font-light text-gray-800",children:(0,p.fK)(l.current_price)})]}),(0,a.jsxs)("p",{className:"mt-2 text-gray-600 capitalize",children:["from: ",l.liquidator_name]})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Starting Bid:"}),(0,a.jsxs)("span",{className:"ml-10 text-3xl font-light text-gray-800",children:["₹",l.starting_price]})]})})}),(0,a.jsx)("div",{className:"relative py-4 grid grid-cols-3 gap-4 mt-6",children:z>0&&"closed"!==l.status?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"bg-white rounded-lg px-4 py-3 border border-gray-300 ring-accent col-span-2 relative",children:[(0,a.jsx)("span",{className:"absolute left-4 top-1/2 transform -translate-y-1/2",children:"₹"}),(0,a.jsx)("input",{className:"outline-none px-6 w-full text-xl",type:"number",name:"bidValue",value:j,onChange:e=>{P(e.target.value)},onKeyDown:e=>{("ArrowUp"===e.key||"ArrowDown"===e.key)&&e.preventDefault()},autoComplete:"false",placeholder:"Enter your bid amount"})]}),(0,a.jsx)("button",{className:"bg-accent text-white rounded-lg py-3 transition-all ring-accent",onClick:eu,children:V?(0,a.jsx)("span",{className:"inline-block w-4 h-4 border-2 border-white border-t-transparent  rounded-full animate-spin"}):"Place Bid"}),(0,a.jsx)("span",{className:"col-span-3 ".concat(q?"visible":"invisible"," text-sm text-red-500 mt-2"),children:"Please select the checkbox"}),(0,a.jsxs)("span",{className:"col-span-3 text-sm mt-4",children:["Learn more about how bidding works in our"," ",(0,a.jsx)("a",{className:"accent hover:underline",href:"/sample.pdf",target:"_blank",children:"auction bidding guide"}),"."]}),(0,a.jsxs)(v.K,{color:"success",radius:"sm",isSelected:1===B[1],onValueChange:()=>{D(e=>{let s={...e};return 1===s[1]?delete s[1]:s[1]=1,s})},classNames:{base:"text-white col-span-3"},children:[(0,a.jsx)("p",{className:"ms-3",children:"I agree to pay if I win this auction"}),(0,a.jsx)("p",{className:"ms-3 text-sm text-gray-500",children:"Additional condition"})]})]}):"closed"===l.status?(0,a.jsxs)("p",{className:"text-red-600 bg-red-100 border border-red-300 rounded-lg px-4 py-3 mt-4 col-span-3",children:[(0,a.jsx)("i",{className:"bi bi-exclamation-circle-fill text-xl me-2"}),"Auction Has ended, please visit home page to view more auctions."]}):(0,a.jsxs)("p",{className:"text-red-600 bg-red-100 border border-red-300 rounded-lg px-4 py-3 mt-4 col-span-3",children:[(0,a.jsx)("i",{className:"bi bi-exclamation-circle-fill text-xl me-2"}),"Your balance is insufficient. Please recharge your"," ",(0,a.jsxs)(g(),{className:"underline",href:"/liquidator/profile/wallet",children:[" ","wallet"]})," ","to place more bids."]})})]})]}),(0,a.jsxs)("div",{className:"sticky top-28 h-fit flex flex-col gap-y-4",children:[(0,a.jsxs)("div",{className:"p-6 bg-white shadow-lg rounded-lg h-fit",children:[(0,a.jsxs)("div",{className:"text-xl font-semibold text-gray-800 flex items-center space-x-2",children:[(0,a.jsx)("i",{className:"bi bi-clock"}),(0,a.jsx)("span",{children:"Timed Auction"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 w-full gap-x-2 mt-4",children:[(0,a.jsx)("span",{className:"col-span-1 text-center font-medium text-gray-600",children:"Auction ends:"}),(0,a.jsx)("span",{className:"col-span-2 text-center font-semibold text-gray-800",children:new Date(l.closing_time).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})})]}),(0,a.jsx)("div",{className:"w-full mt-6",children:(0,a.jsx)(n.U,{className:"bg-white shadow-lg rounded-lg",transition:!0,transitionTimeout:250,children:(0,a.jsxs)(y.Z,{header:(0,a.jsx)("span",{className:"text-gray-800 font-medium",children:"Additional Fees"}),children:[(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Fees apply to the hammer price:"}),(0,a.jsx)("p",{className:"font-semibold my-2 text-gray-800",children:"Free Registration"}),(0,a.jsx)("p",{className:"text-gray-600",children:"27.6% inc VAT*"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-6",children:"*These fees include buyers premiums and internet surcharges."}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Please see the auctioneers & conditions for more information"})]})})})]}),(0,a.jsxs)("div",{className:"p-6 bg-white shadow-lg rounded-lg h-fit grid grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Time Left:"}),(0,a.jsx)("p",{children:"My Max Bid:"}),(0,a.jsx)("p",{children:"Bids:"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:(0,a.jsx)(r.Z,{closingTime:l.closing_time})}),(0,a.jsx)("p",{children:O?(0,p.fK)(O):"-"}),(0,a.jsx)("p",{children:(null==l?void 0:l.wager_count)?null==l?void 0:l.wager_count:0})]})]}),(0,a.jsxs)("div",{className:"p-6 bg-white shadow-lg rounded-lg grid grid-cols-2 h-fit max-h-[600px] overflow-y-scroll scrollbar-hidden",children:[(0,a.jsxs)("div",{className:"text-xl font-semibold text-gray-800 flex items-center space-x-2 col-span-2 mb-5 ",children:[(0,a.jsx)("i",{className:"bi bi-cash"}),(0,a.jsx)("span",{children:"Bids Placed:"})]}),U.length>0?(0,a.jsxs)("table",{className:"col-span-2 w-full text-center border-collapse border border-gray-300",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-200 border-b border-gray-300",children:[(0,a.jsx)("th",{className:"py-2 px-4 text-gray-700",children:"User"}),(0,a.jsx)("th",{className:"py-2 px-4 text-gray-700",children:"Bid Amount"})]})}),(0,a.jsx)("tbody",{children:U.map((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-100",children:[(0,a.jsx)("td",{className:"py-2 px-4 border-b border-gray-300",children:e.liquidator_name}),(0,a.jsx)("td",{className:"py-2 px-4 border-b border-gray-300",children:(0,p.fK)(e.wager_amount)})]},s))})]}):(0,a.jsx)("div",{className:"flex justify-center items-center bg-[#f5f5f5] border border-[#42c8b7] text-[#42c8b7] rounded-lg py-4 px-6 mt-4 col-span-2",children:(0,a.jsx)("p",{className:"font-semibold text-lg",children:"No Bids to Show!"})})]})]})]}),(0,a.jsx)(_.R,{isOpen:Y,onOpenChange:ee,size:"xl",children:(0,a.jsx)(S.A,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.k,{className:"flex flex-col gap-1",children:"Auction Devices"}),(0,a.jsxs)(k.I,{children:[(0,a.jsxs)("table",{className:"min-w-full table-auto bg-white rounded overflow-hidden shadow",children:[(0,a.jsx)("thead",{className:"bg-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-center py-2.5",children:"No."}),(0,a.jsx)("th",{className:"text-center py-2.5",children:"Brand"}),(0,a.jsx)("th",{className:"text-center py-2.5",children:"Model"})]})}),en?(0,a.jsx)("tbody",{className:"divide-y",children:Array.from({length:10}).map((e,s)=>(0,a.jsxs)("tr",{className:"divide-x",children:[(0,a.jsx)("td",{className:"py-1.5 px-2 text-center",children:(0,a.jsx)(E.X,{className:"h-5 rounded-full"})}),(0,a.jsx)("td",{className:"py-1.5 px-2 text-center",children:(0,a.jsx)(E.X,{className:"h-5 rounded-full"})}),(0,a.jsx)("td",{className:"py-1.5 px-2 text-center",children:(0,a.jsx)(E.X,{className:"h-5 rounded-full"})})]},s))}):Q&&Q.length>0?(0,a.jsx)("tbody",{className:"divide-y",children:Q.map((e,s)=>(0,a.jsxs)("tr",{className:"divide-x",children:[(0,a.jsx)("td",{className:"py-2.5 text-center",children:s+1}),(0,a.jsx)("td",{className:"py-2.5 text-center",children:e.name}),(0,a.jsx)("td",{className:"py-2.5 text-center",children:e.variant_name})]},s))}):(0,a.jsx)("td",{className:"w-full border py-4 text-center text-red-500 font-semibold","aria-colspan":3,colspan:3,children:"No entries to show!"})]}),ea>1&&(0,a.jsx)(I.g,{showControls:!0,color:"success",total:ea,page:es,onChange:et,classNames:{cursor:"text-white",base:"mx-auto"}})]}),(0,a.jsx)(C.R,{children:(0,a.jsx)(w.A,{color:"danger",variant:"light",onPress:e,className:"rounded",children:"Close"})})]})})})]}):(0,a.jsx)("div",{className:"h-screen flex justify-center mt-40",children:(0,a.jsx)("h2",{className:"text-red-500",children:"Error: Something went wrong"})})}}},function(e){e.O(0,[8838,1773,9090,3882,2888,9774,179],function(){return e(e.s=3511)}),_N_E=e.O()}]);