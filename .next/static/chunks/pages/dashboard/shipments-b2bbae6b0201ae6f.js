(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[88],{1950:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/shipments",function(){return s(1185)}])},8864:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{default:function(){return i},noSSR:function(){return n}});let a=s(8754);s(5893),s(7294);let r=a._(s(6016));function l(e){return{default:(null==e?void 0:e.default)||e}}function n(e,t){return delete t.webpack,delete t.modules,e(t)}function i(e,t){let s=r.default,a={loading:e=>{let{error:t,isLoading:s,pastDelay:a}=e;return null}};e instanceof Promise?a.loader=()=>e:"function"==typeof e?a.loader=e:"object"==typeof e&&(a={...a,...e});let i=(a={...a,...t}).loader;return(a.loadableGenerated&&(a={...a,...a.loadableGenerated},delete a.loadableGenerated),"boolean"!=typeof a.ssr||a.ssr)?s({...a,loader:()=>null!=i?i().then(l):Promise.resolve(l(()=>null))}):(delete a.webpack,delete a.modules,n(s,a))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},572:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return a}});let a=s(8754)._(s(7294)).default.createContext(null)},6016:function(e,t,s){"use strict";/**
@copyright (c) 2017-present James Kyle <me@thejameskyle.com>
 MIT License
 Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:
 The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.
 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE
*/Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return h}});let a=s(8754)._(s(7294)),r=s(572),l=[],n=[],i=!1;function o(e){let t=e(),s={loading:!0,loaded:null,error:null};return s.promise=t.then(e=>(s.loading=!1,s.loaded=e,e)).catch(e=>{throw s.loading=!1,s.error=e,e}),s}class c{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function d(e){return function(e,t){let s=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),l=null;function o(){if(!l){let t=new c(e,s);l={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return l.promise()}if(!i){let e=s.webpack?s.webpack():s.modules;e&&n.push(t=>{for(let s of e)if(t.includes(s))return o()})}function d(e,t){!function(){o();let e=a.default.useContext(r.LoadableContext);e&&Array.isArray(s.modules)&&s.modules.forEach(t=>{e(t)})}();let n=a.default.useSyncExternalStore(l.subscribe,l.getCurrentValue,l.getCurrentValue);return a.default.useImperativeHandle(t,()=>({retry:l.retry}),[]),a.default.useMemo(()=>{var t;return n.loading||n.error?a.default.createElement(s.loading,{isLoading:n.loading,pastDelay:n.pastDelay,timedOut:n.timedOut,error:n.error,retry:l.retry}):n.loaded?a.default.createElement((t=n.loaded)&&t.default?t.default:t,e):null},[e,n])}return d.preload=()=>o(),d.displayName="LoadableComponent",a.default.forwardRef(d)}(o,e)}function u(e,t){let s=[];for(;e.length;){let a=e.pop();s.push(a(t))}return Promise.all(s).then(()=>{if(e.length)return u(e,t)})}d.preloadAll=()=>new Promise((e,t)=>{u(l).then(e,t)}),d.preloadReady=e=>(void 0===e&&(e=[]),new Promise(t=>{let s=()=>(i=!0,t());u(n,e).then(s,s)})),window.__NEXT_PRELOADREADY=d.preloadReady;let h=d},2115:function(e,t,s){"use strict";var a=s(5893);s(7294),t.Z=e=>{let{itemsPerPage:t,setItemsPerPage:s,currentPage:r,setCurrentPage:l,totalEntries:n,totalPages:i}=e;return(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("label",{htmlFor:"items",className:"text-sm",children:"Items per page:"}),(0,a.jsx)("select",{id:"items",className:"border border-gray-300 rounded-md py-1 px-2 outline-none",value:t,onChange:e=>{s(parseInt(e.target.value,10)),l(1)},children:[15,20,25,30,35].map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-3 md:mt-0",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:[t*r-t+1," to"," ",t*r<n?t*r:n," ","of ",n]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("button",{onClick:()=>l(1),disabled:1===r,className:"p-2 rounded-full ".concat(r>1?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-bar-left text-lg"})}),(0,a.jsx)("button",{onClick:()=>l(e=>e>1?e-1:e),disabled:1===r,className:"p-2 rounded-full ".concat(r>1?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-left text-lg"})}),(0,a.jsx)("button",{onClick:()=>l(e=>e<i?e+1:e),disabled:r===i,className:"p-2 rounded-full ".concat(r<i?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-right text-lg"})}),(0,a.jsx)("button",{onClick:()=>l(i),disabled:r===i,className:"p-2 rounded-full ".concat(r<i?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-bar-right text-lg"})})]})]})]})}},4625:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(7294);function r(e,t){let[s,r]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let s=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(s)}},[e,t]),s}},1185:function(e,t,s){"use strict";s.r(t);var a=s(5893),r=s(7294),l=s(4625),n=s(2115),i=s(1163),o=s(9134),c=s(5066),d=s(1664),u=s.n(d),h=s(373),m=s(5152),p=s.n(m),f=s(6455),x=s.n(f);p()(()=>s.e(607).then(s.t.bind(s,8607,23)),{loadableGenerated:{webpack:()=>[8607]},ssr:!1}),t.default=()=>{let e="https://buybackservice.unicornstore.in";(0,i.useRouter)();let[t,s]=(0,r.useState)(null),[d,m]=(0,r.useState)(10),[p,f]=(0,r.useState)(1),[b,g]=(0,r.useState)(null),[y,_]=(0,r.useState)(null),[j,N]=(0,r.useState)(""),w=(0,l.Z)(j,500),[v,C]=(0,r.useState)(!1),[k,S]=(0,r.useState)(""),[E,P]=(0,r.useState)(""),[O,T]=(0,r.useState)(null),D=async()=>{let t=localStorage.getItem("staff_id");try{C(!0);let a=await fetch("".concat(e,"/get-all-shipments?page=").concat(p,"&per_page=").concat(d,"&sort_desc=false&search=").concat(j,"&staff_id=").concat(t));if(!a.ok)throw Error("Could not get shipment Res");let r=await a.json();s(r.data),_(r.total_count),g(Math.ceil(r.total_count/d)),r.data.forEach(e=>{S(t=>({...t,[e.shipment_id]:e.status}))})}catch(e){o.Am.error(e.message)}finally{C(!1)}};(0,r.useEffect)(()=>{T(localStorage.getItem("staff_id")),D()},[]),(0,r.useEffect)(()=>{""!==w&&(f(1),D())},[w,j]);let A=async(t,s)=>{try{let a=await fetch("".concat(e,"/update-shipment?shipment_id=").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})});if(!a.ok)throw Error("Could not update shipment");let r=await a.json();if("success"!==r.status)throw Error(r.message);S(e=>({...e,[t]:s})),D()}catch(e){o.Am.error(e.message)}},R=async t=>{try{let s=await fetch("".concat(e,"/delete-shipment?shipment_id=").concat(t),{method:"DELETE"});if(!s.ok)throw Error("Could not delete shipment");let a=await s.json();if("success"!==a.status)throw Error(a.message)}catch(e){o.Am.error(e.message)}},I=async t=>{console.log({id:t});try{let s=await fetch("".concat(e,"/packing-slip-pdf/?shipment_id=").concat(t));if(!s.ok)throw Error("Could not get slip");let a=await s.json();if("success"!==a.status)throw Error(a.message);console.log({slipData:a}),window.open(a.url,"_blank")}catch(e){o.Am.error(e.message)}},L=async t=>{try{let s=await fetch("".concat(e,"/track-delivery/?shipment_id=").concat(t),{method:"POST"});if(!s.ok)throw Error("Could not track shipment");let a=await s.json();if("success"!==a.status)throw Error(a.message);x().fire({title:"Shipment Status",text:a.shipment_status,icon:"success"})}catch(e){o.Am.error(e.message)}};return(0,a.jsx)("div",{className:"flex justify-center bg-gray-100 min-h-screen h-full relative -top-28",children:(0,a.jsx)("div",{className:"container max-w-screen-xl",children:(0,a.jsxs)("div",{className:"flex flex-col bg-white p-4 my-4 rounded-lg shadow justify-center space-y-2",children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)(u(),{href:"/dashboard/shipments/create-shipment",className:"bg-accent text-white px-4 py-2 rounded",children:[(0,a.jsx)("i",{className:"bi bi-plus-lg"})," Create Shipment"]})}),(0,a.jsx)("label",{className:"text-sm text-gray-700",children:"Search by Customer Name, Final Price or Product Name"}),(0,a.jsx)("span",{className:"w-full grid grid-cols-1 md:grid-cols-6 md:space-x-2",children:(0,a.jsx)("input",{type:"text",className:"border border-gray-400 py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-[#42c8b7] col-span-6",name:"search-bar",value:j,onChange:e=>N(e.target.value),spellCheck:!1,autoComplete:"off",placeholder:"Search by Customer Name, Final Price or Product Name"})}),t&&t.length>0?(0,a.jsxs)("table",{className:"min-w-full table-auto bg-white rounded overflow-hidden shadow",children:[(0,a.jsx)("thead",{className:"bg-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-center cursor-pointer py-2.5",children:"Shipment ID"}),(0,a.jsx)("th",{className:"text-center cursor-pointer py-2.5",children:"Store"}),(0,a.jsx)("th",{className:"text-center cursor-pointer py-2.5",children:"Shipping Class"}),(0,a.jsx)("th",{className:"text-center cursor-pointer py-2.5",children:"Requested On"}),(0,a.jsx)("th",{className:"text-center cursor-pointer py-2.5",children:"Status"}),(0,a.jsx)("th",{className:"text-center cursor-pointer py-2.5",children:"Weight"}),(0,a.jsx)("th",{className:"text-center cursor-pointer py-2.5",children:"Dimensions"}),(0,a.jsx)("th",{className:"text-center cursor-pointer py-2.5",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:t.map((e,t)=>(0,a.jsxs)("tr",{className:"divide-x",children:[(0,a.jsx)("td",{className:"py-1.5 text-center",children:e.shipment_id}),(0,a.jsx)("td",{className:"py-1.5 text-center",children:e.store}),(0,a.jsx)("td",{className:"py-1.5 text-center",children:e.shipping_class}),(0,a.jsx)("td",{className:"py-1.5 text-center",children:e.shipping_requested_date?(0,c.a)(e.shipping_requested_date):"-"}),(0,a.jsx)("td",{className:"py-1.5 text-center",children:"completed"!==e.status?(0,a.jsx)("span",{className:"pe-1 py-1 border border-gray-300 rounded",children:(0,a.jsxs)("select",{name:"status",id:"status",className:"px-2 outline-none",value:k[e.shipment_id],onChange:t=>{A(e.shipment_id,t.target.value)},children:[(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"shipped",children:"Shipped"})]})}):"Delivered"}),(0,a.jsx)("td",{className:"py-1.5 text-center",children:e.weight_in_kg}),(0,a.jsx)("td",{className:"py-1.5 text-center",children:Object.values(e.box_dimensions).join(" x ")}),(0,a.jsxs)("td",{className:" py-4 whitespace-nowrap text-sm font-medium text-center",children:["pending"!==e.status&&(0,a.jsx)("button",{className:"text-purple-500 hover:text-white bg-purple-100 hover:bg-purple-500 py-1 px-1.5 rounded transition-all me-2",onClick:()=>L(e.shipment_id),children:(0,a.jsx)("i",{className:"bi bi-truck"})}),(0,a.jsxs)("button",{className:"text-blue-500 hover:text-white bg-blue-100 hover:bg-blue-500 py-1 px-1.5 rounded transition-all me-2",onClick:()=>I(e.shipment_id),children:["Slip ",(0,a.jsx)("i",{className:"bi bi-printer"})]}),(0,a.jsx)("button",{className:"text-red-500 hover:text-white bg-red-100 hover:bg-red-500 py-1 px-1.5 rounded transition-all",onClick:()=>P(e.shipment_id),children:(0,a.jsx)("i",{className:"bi bi-trash-fill"})}),E===e.shipment_id&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg w-96 p-6 text-wrap",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Delete Item"}),(0,a.jsx)("p",{className:"mb-6",children:"Are you sure you want to delete this item? This action cannot be undone."}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:()=>P(""),className:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>R(e.shipment_id),className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",children:"Confirm Delete"})]})]})})]})]},t))})]}):v?(0,a.jsx)("div",{className:"flex w-full justify-center",children:(0,a.jsx)(h.Z,{color:"#42c8b7",loading:v,size:40,"aria-label":"Loading Spinner","data-testid":"loader"})}):(0,a.jsx)("div",{className:"w-full border py-4 text-center text-red-500 font-semibold",children:"No entries to show!"}),(0,a.jsx)(n.Z,{itemsPerPage:d,setItemsPerPage:m,currentPage:p,setCurrentPage:f,totalEntries:y,totalPages:b})]})})})}},5152:function(e,t,s){e.exports=s(8864)}},function(e){e.O(0,[166,888,774,179],function(){return e(e.s=1950)}),_N_E=e.O()}]);