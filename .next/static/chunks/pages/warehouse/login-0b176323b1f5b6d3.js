(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6868],{21603:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/warehouse/login",function(){return r(82383)}])},82383:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var n=r(85893),a=r(39412),s=r(11163),o=r(67294),l=r(9134),u=r(58386),i=r(9008),c=r.n(i),d=()=>{let e="https://buybackservice.unicornstore.in",[t,r]=(0,o.useState)(!1),[i,d]=(0,o.useState)(""),m=(0,s.useRouter)(),[p,h]=(0,o.useState)({username:"",password:""}),[f,g]=(0,o.useState)({username:"",password:""}),[w,b]=(0,o.useState)("username"),[x,v]=(0,o.useState)(""),[y,j]=(0,o.useState)(!1),[N,S]=(0,o.useState)(0),[k,P]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=localStorage.getItem("warehouse_token"),t=localStorage.getItem("warehouse_name");e&&t&&m.replace("/warehouse")},[m]);let _=e=>{let{name:t,value:r}=e.target;h({...p,[t]:r}),"phone"===w&&j(!1),g(e=>{let n={...e};return"username"===t&&(r.trim()?"phone"===w&&10!==r.length?n.username="Phone number must be 10 digits":n.username="":n.username="".concat("username"===w?"Username":"Phone number"," is required")),"password"===t&&(r.trim()?n.password="":n.password="Password is required"),n})},E=()=>{let e={};return p.username.trim()||(e.username="".concat("username"===w?"Username":"Phone number"," is required")),"phone"===w&&10!==p.username.length&&(e.username="Phone number must be 10 digits"),"username"!==w||p.password.trim()||(e.password="Password is required"),"phone"===w&&y&&!x.trim()&&(e.password="OTP is required"),g(e),0===Object.keys(e).length},C=async t=>{if(t.preventDefault(),E())try{P(!0);let t=new FormData;t.append("username",p.username),t.append("password",p.password);let r=await fetch("".concat(e,"/warehouse/token"),{method:"POST",body:t});if(!r.ok){d("Invalid username or password");return}let n=await r.json();localStorage.setItem("warehouse_token",n.access_token),localStorage.setItem("warehouse_name",n.name),localStorage.setItem("warehouse_id",n.warehouse_id),m.push("/warehouse/shipments")}catch(e){l.Am.error(e.message,{toastId:"warhouseLoginError"})}finally{P(!1)}},I=async t=>{if(t.preventDefault(),E()){if(!y){O();return}try{P(!0),d(null);let t=await fetch("".concat(e,"/warehouse/otp/login"),{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({number:p.username,otp:x})});if(!t.ok)throw Error("Could not confirm OTP");let r=await t.json();if("success"!==r.status)throw Error(r.message);if(!r.access_token||!r.name||!r.warehouse_id)throw Error("API response not complete");localStorage.setItem("warehouse_token",r.access_token),localStorage.setItem("warehouse_name",r.name),localStorage.setItem("warehouse_id",r.warehouse_id),m.replace("/warehouse")}catch(e){d("Something went wrong: ".concat(e.message)),l.Am.error(e.message)}finally{P(!1)}}},O=async()=>{try{P(!0);let t=await fetch("".concat(e,"/warehouse/send/otp/"),{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({number:p.username})});if(!t.ok)throw Error("Could not send OTP");let r=await t.json();if("success"!==r.status)throw Error(r.message)}catch(e){l.Am.error(e.message)}finally{P(!1),j(!0),S(60)}},D=async()=>{D>0||O()};return(0,o.useEffect)(()=>{let e;return N>0&&(e=setInterval(()=>{S(e=>e-1)},1e3)),()=>clearInterval(e)},[N]),(0,n.jsxs)("div",{className:"flex items-center justify-center py-20 mt-24",children:[(0,n.jsx)(c(),{children:(0,n.jsx)("title",{children:"BuyBack - Warehouse Login"})}),(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-center mb-6",children:"Warehouse Login"}),"username"===w&&(0,n.jsxs)("form",{onSubmit:e=>C(e),children:[(0,n.jsxs)("div",{className:"mb-6 relative",children:[(0,n.jsx)("label",{htmlFor:"username",className:"block text-gray-700 mb-0.5",children:"Username or Email Address"}),(0,n.jsx)("input",{type:"text",id:"username",name:"username",value:p.username,onChange:e=>_(e),className:"w-full p-3 border border-gray-300 rounded-lg ring-accent ".concat(f.username?"border-red-300":""),placeholder:"Enter username or email",autoComplete:"email"}),f.username&&(0,n.jsx)("span",{className:"text-red-500 text-xs absolute left-0 -bottom-5",children:f.username})]}),(0,n.jsxs)("div",{className:"mb-6 relative",children:[(0,n.jsx)("label",{htmlFor:"password",className:"block text-gray-700 mb-0.5",children:"Password"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{type:t?"text":"password",id:"password",name:"password",value:p.password,onChange:e=>_(e),className:"w-full p-3 border border-gray-300 rounded-lg ring-accent ".concat(f.password?"border-red-300":""),placeholder:"Enter password",autoComplete:"current-password"}),(0,n.jsx)("button",{type:"button",tabIndex:0,className:"absolute inset-y-0 text-gray-500 cursor-pointer content-center right-0 pe-3 ps-3 rounded-e-lg hover:bg-gray-100 hover:bg-opacity-50 focus:bg-gray-200 focus:bg-opacity-50 outline-none",onClick:()=>{r(e=>!e)},children:(0,n.jsx)("i",{className:"bi ".concat(t?"bi-eye-slash":"bi-eye")})})]}),f.password&&(0,n.jsx)("span",{className:"text-red-500 text-xs absolute left-0 -bottom-5",children:f.password})]}),i&&(0,n.jsx)("p",{className:"text-red-500 text-sm mb-4",children:i}),(0,n.jsx)(a.A,{isLoading:k,type:"submit",className:"w-full bg-accent text-white p-3 rounded-lg transition duration-300",children:"Login"})]}),"phone"===w&&(0,n.jsxs)("form",{onSubmit:e=>I(e),children:[(0,n.jsxs)("div",{className:"mb-4 relative",children:[(0,n.jsx)("label",{htmlFor:"username",className:"block text-gray-700 mb-2",children:"Phone Number"}),(0,n.jsx)("input",{type:"number",id:"username",name:"username",value:p.username,onChange:e=>_(e),className:"w-full p-3 border border-gray-300 rounded-lg ring-accent ".concat(f.username?"border-red-300":""),placeholder:"Enter your phone number",autoComplete:"tel"}),f.username&&(0,n.jsx)("span",{className:"text-red-500 text-xs",children:f.username})]}),(0,n.jsxs)("div",{className:"mb-4 relative",children:[(0,n.jsx)("label",{htmlFor:"OTP",className:"block text-gray-700 mb-2",children:"OTP"}),(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)(u.Z,{id:"OTP",value:x,onChange:v,numInputs:6,renderSeparator:(0,n.jsx)("span",{children:"\xa0"}),inputStyle:"border rounded p-0.5 !w-8 outline-none",renderInput:e=>(0,n.jsx)("input",{...e})})}),f.password&&(0,n.jsx)("span",{className:"text-red-500 text-xs",children:f.password})]}),i&&(0,n.jsx)("p",{className:"text-red-500 text-sm mb-4",children:i}),(0,n.jsx)(a.A,{isLoading:k,type:"submit",className:"w-full bg-accent text-white p-3 rounded-lg transition duration-300 ring-accent",children:y?"Login":"Send OTP"})]}),(0,n.jsxs)("div",{className:"relative flex justify-between mt-4",children:["phone"===w&&y&&(0,n.jsxs)("button",{className:"w-fit block mr-auto accent disabled:text-gray-400",disabled:N>0,onClick:D,children:["Resend OTP ",N>0?"in ".concat(N):""]}),(0,n.jsxs)("button",{className:"w-fit block ml-auto accent cursor-pointer",onClick:()=>{b(e=>"username"===e?"phone":"username"),g({username:"",password:""}),h({username:"",password:""}),v(""),j(!1)},children:["Login with"," ","username"===w?"phone number?":"username?"]})]})]})]})},m=()=>(0,n.jsx)("div",{children:(0,n.jsx)(d,{})})},9008:function(e,t,r){e.exports=r(7828)},58386:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(67294),a=function(e){return"object"==typeof e&&null!==e},s=function(e){var t=e.value,r=void 0===t?"":t,s=e.numInputs,o=void 0===s?4:s,l=e.onChange,u=e.onPaste,i=e.renderInput,c=e.shouldAutoFocus,d=void 0!==c&&c,m=e.inputType,p=void 0===m?"text":m,h=e.renderSeparator,f=e.placeholder,g=e.containerStyle,w=e.inputStyle,b=e.skipDefaultStyles,x=void 0!==b&&b,v=n.useState(0),y=v[0],j=v[1],N=n.useRef([]),S=function(){return r?r.toString().split(""):[]},k="number"===p||"tel"===p;n.useEffect(function(){N.current=N.current.slice(0,o)},[o]),n.useEffect(function(){var e;d&&(null===(e=N.current[0])||void 0===e||e.focus())},[d]);var P=function(){if("string"==typeof f){if(f.length===o)return f;f.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}},_=function(e){return(k?!isNaN(Number(e)):"string"==typeof e)&&1===e.trim().length},E=function(e){var t=e.target.value;_(t)&&(T(t),D(y+1))},C=function(e){var t=e.nativeEvent,r=e.target.value;_(r)||(r.length!==o||r.split("").some(function(e){return!_(e)})||(A(r.split("")),D(o-1)),null===t.data&&"deleteContentBackward"===t.inputType&&(e.preventDefault(),T(""),D(y-1)),e.target.value="")},I=function(){j(y-1)},O=function(e){var t=S();[e.code,e.key].includes("Backspace")?(e.preventDefault(),T(""),D(y-1)):"Delete"===e.code?(e.preventDefault(),T("")):"ArrowLeft"===e.code?(e.preventDefault(),D(y-1)):"ArrowRight"===e.code?(e.preventDefault(),D(y+1)):e.key===t[y]?(e.preventDefault(),D(y+1)):("Spacebar"===e.code||"Space"===e.code||"ArrowUp"===e.code||"ArrowDown"===e.code)&&e.preventDefault()},D=function(e){var t,r,n=Math.max(Math.min(o-1,e),0);N.current[n]&&(null===(t=N.current[n])||void 0===t||t.focus(),null===(r=N.current[n])||void 0===r||r.select(),j(n))},T=function(e){var t=S();t[y]=e[0],A(t)},A=function(e){l(e.join(""))},L=function(e){e.preventDefault();var t,r=S(),n=y,a=e.clipboardData.getData("text/plain").slice(0,o-y).split("");if(!(k&&a.some(function(e){return isNaN(Number(e))}))){for(var s=0;s<o;++s)s>=y&&a.length>0&&(r[s]=null!==(t=a.shift())&&void 0!==t?t:"",n++);D(n),A(r)}};return n.createElement("div",{style:Object.assign({display:"flex",alignItems:"center"},a(g)&&g),className:"string"==typeof g?g:void 0,onPaste:u},Array.from({length:o},function(e,t){return t}).map(function(e){var t,r,s;return n.createElement(n.Fragment,{key:e},i({value:null!==(t=S()[e])&&void 0!==t?t:"",placeholder:null!==(s=null===(r=P())||void 0===r?void 0:r[e])&&void 0!==s?s:void 0,ref:function(t){return N.current[e]=t},onChange:E,onFocus:function(t){j(e),t.target.select()},onBlur:I,onKeyDown:O,onPaste:L,autoComplete:"off","aria-label":"Please enter OTP character ".concat(e+1),style:Object.assign(x?{}:{width:"1em",textAlign:"center"},a(w)?w:{}),className:"string"==typeof w?w:void 0,type:p,inputMode:k?"numeric":"text",onInput:C},e),e<o-1&&("function"==typeof h?h(e):h))}))}}},function(e){e.O(0,[2888,9774,179],function(){return e(e.s=21603)}),_N_E=e.O()}]);