(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2842],{20779:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/pending_orders",function(){return t(99133)}])},12115:function(e,s,t){"use strict";var a=t(85893);t(67294),s.Z=e=>{let{itemsPerPage:s,setItemsPerPage:t,currentPage:r,setCurrentPage:n,totalEntries:c,totalPages:l}=e;return(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("label",{htmlFor:"items",className:"text-sm",children:"Items per page:"}),(0,a.jsx)("select",{id:"items",className:"border border-gray-300 rounded-md py-1 px-2 ring-accent",value:s,onChange:e=>{t(parseInt(e.target.value,10)),n(1)},children:[15,20,25,30,35].map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-3 md:mt-0",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:[s*r-s+1," to"," ",s*r<c?s*r:c," ","of ",c]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("button",{onClick:()=>n(1),disabled:1===r,className:"p-2 rounded-full ring-accent ".concat(r>1?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-bar-left text-lg"})}),(0,a.jsx)("button",{onClick:()=>n(e=>e>1?e-1:e),disabled:1===r,className:"p-2 rounded-full ring-accent ".concat(r>1?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-left text-lg"})}),(0,a.jsx)("button",{onClick:()=>n(e=>e<l?e+1:e),disabled:r===l,className:"p-2 rounded-full ring-accent ".concat(r<l?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-right text-lg"})}),(0,a.jsx)("button",{onClick:()=>n(l),disabled:r===l,className:"p-2 rounded-full ring-accent ".concat(r<l?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-bar-right text-lg"})})]})]})]})}},4625:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});var a=t(67294);function r(e,s){let[t,r]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let t=setTimeout(()=>{r(e)},s);return()=>{clearTimeout(t)}},[e,s]),t}},99133:function(e,s,t){"use strict";t.r(s);var a=t(85893),r=t(67294),n=t(4625),c=t(12115),l=t(67957),i=t(8455),d=t(49621),o=t(14930),x=t(4483),m=t(10405),h=t(44265),u=t(87740),p=t(86597),j=t(96476),g=t(32553);t(55961);var b=t(5152),f=t.n(b),N=t(9134),v=t(9008),y=t.n(v);f()(()=>t.e(8607).then(t.t.bind(t,68607,23)),{loadableGenerated:{webpack:()=>[68607]},ssr:!1}),s.default=()=>{var e;let s="https://buybackservice.unicornstore.in",[t,b]=(0,r.useState)(""),[f,v]=(0,r.useState)([]),[w,k]=(0,r.useState)(15),[_,C]=(0,r.useState)(1),[S,P]=(0,r.useState)(1),[D,A]=(0,r.useState)(!0),[F,q]=(0,r.useState)(""),[O,E]=(0,r.useState)(""),[I,R]=(0,r.useState)(""),[Q,T]=(0,r.useState)(""),[B,L]=(0,r.useState)({key:"",direction:"ascending"}),[U,Z]=(0,r.useState)([]),[z,X]=(0,r.useState)({startDate:"",endDate:""}),[G,K]=(0,r.useState)([]),[M,H]=(0,r.useState)({qna:"",feedback:[]}),{isOpen:J,onOpen:V,onClose:W}=(0,l.q)(),{isOpen:Y,onOpen:$,onClose:ee}=(0,l.q)(),es=(0,g.dQ)(),et=e=>{let{name:s,value:t}=e.target;"location"===s&&shipmentID||X(e=>({...e,[s]:t}))},ea=async()=>{A(!0);try{let e=B.key,a="descending"===B.direction,r=await fetch("".concat(s,"/get-order-details-by-staff?staff_id=").concat(t,"&per_page=").concat(w,"&page=").concat(S,"&search=").concat(I,"&sort_by=").concat(e,"&sort_desc=").concat(a,"&from_date=").concat(z.startDate,"&to_date=").concat(z.endDate,"&status=Pending"),{headers:{Authorization:es}});if(!r.ok)throw Error("Could not get order details by staff id");let n=await r.json();0===n.data.length?T("No entries found, please refine your search query"):T(""),v(n.data.length>0?n.data:[]),C(Math.ceil(n.total_count/w)),E(n.total_count),q("")}catch(e){console.log(e),q(e)}finally{setTimeout(()=>{A(!1)},300)}},er=e=>{let s="ascending";B.key===e&&"ascending"===B.direction&&(s="descending"),L({key:e,direction:s}),P(1)};(0,r.useEffect)(()=>{b(localStorage.getItem("staff_id")),t&&ea()},[t,w,S,B]);let en=(0,n.Z)(I,500);(0,r.useEffect)(()=>{""!==en&&(P(1),ea())},[en,I]);let ec=e=>B.key!==e?null:"ascending"===B.direction?(0,a.jsx)("i",{className:"fas fa-arrow-up"}):(0,a.jsx)("i",{className:"fas fa-arrow-down"}),el=async()=>{try{let e=await fetch("".concat(s,"/generate-orders-excel/?staff_id=").concat(t,"&show_pending=true"));if(!e.ok)throw Error("Could not download excel");let a=await e.blob(),r=window.URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.setAttribute("download","Orders.xlsx"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}catch(e){N.Am.error(e.message)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y(),{children:(0,a.jsx)("title",{children:"BuyBack - Store Dashboard | Pending Orders"})}),(0,a.jsx)("div",{className:"flex justify-center bg-gray-100 min-h-screen relative -top-28",children:(0,a.jsx)("div",{className:"container max-w-screen-xl mx-4",children:(0,a.jsxs)("div",{className:"flex flex-col justify-center space-y-2 bg-white shadow p-4 my-4 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Store Dashboard | Pending Orders"}),(0,a.jsxs)("div",{className:"relative pb-4",children:[(0,a.jsx)(i.d,{variant:"bordered",selectedKeys:U,onSelectionChange:Z,children:(0,a.jsx)(d.G,{"aria-label":"Filters",title:"Filters",startContent:(0,a.jsx)("i",{className:"fas fa-filter"}),children:(0,a.jsxs)("div",{className:"border-t grid grid-cols-2 gap-4 pt-2",children:[(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("label",{htmlFor:"startDate",className:"mb-1",children:"Date From:"}),(0,a.jsx)("input",{type:"date",name:"startDate",id:"startDate",value:z.startDate,onChange:et,className:"px-4 py-1 border rounded w-full outline-none"})]}),(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("label",{htmlFor:"endDate",className:"mb-1",children:"Date To:"}),(0,a.jsx)("input",{type:"date",name:"endDate",id:"endDate",value:z.endDate,onChange:et,className:"px-4 py-1 border rounded w-full outline-none"})]}),(0,a.jsx)("div",{className:"col-span-2 relative flex justify-center",children:(0,a.jsxs)(o.A,{color:"success",className:"rounded text-white ring-accent",onClick:()=>{ea(),Z("0")},children:[(0,a.jsx)("i",{className:"fa-solid fa-filter me-2"}),"Filter"]})})]})},"1")}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2 mt-3",children:[(0,a.jsx)("label",{className:"text-sm text-gray-700",htmlFor:"search-bar",children:"Search by Customer Name, Final Price or Product Name"}),(0,a.jsxs)("div",{className:"w-full flex space-x-2",children:[(0,a.jsx)("input",{type:"text",className:"border border-gray-400 py-2 px-4 rounded-md ring-accent w-full transition-all",name:"search-bar",id:"search-bar",value:I,onChange:e=>R(e.target.value),spellCheck:!1,placeholder:"Search by Customer Name, Final Price or Product Name"}),(0,a.jsxs)("div",{className:"relative space-x-2 w-fit whitespace-nowrap",children:[(0,a.jsx)(o.A,{className:"px-3 py-1 rounded bg-accent text-white cursor-pointer ring-accent h-full",onPress:()=>{R(""),L({key:"",direction:"ascending"}),X({startDate:"",endDate:""})},children:"Clear Filters"}),(0,a.jsx)(o.A,{isIconOnly:!0,className:"rounded bg-accent text-white cursor-pointer h-full ring-accent",onPress:el,"aria-label":"Download Excel File",children:(0,a.jsx)("i",{className:"fas fa-download "})})]})]})]}),(0,a.jsxs)("div",{className:"mt-4 rounded-md p-4 text-md overflow-auto",children:[(0,a.jsxs)("table",{className:"min-w-full whitespace-nowrap table-auto bg-white rounded overflow-hidden shadow",children:[(0,a.jsx)("thead",{className:"bg-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>er("order_detail_id"),children:["Order ID ",ec("order_detail_id")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>er("customer_name"),children:["Customer Name ",ec("customer_name")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>er("product_name"),children:["Product Name ",ec("product_name")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>er("price"),children:["Final Price ",ec("price")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>er("order_status"),children:["Order Status ",ec("order_status")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>er("created_at"),children:["Created On ",ec("created_at")]}),(0,a.jsx)("th",{className:"text-center px-3 py-2.5",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:D?Array(w).fill(0).map((e,s)=>(0,a.jsx)("tr",{className:"divide-x",children:Array(7).fill(0).map((e,s)=>(0,a.jsx)("td",{className:"px-3 py-3",children:(0,a.jsx)(x.X,{className:"h-5 rounded-full"})},s))},s)):f.length>0?f.map((e,s)=>(0,a.jsxs)("tr",{className:"text-center  text-sm md:text-base divide-x hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-1.5 px-3",children:e.order_id}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:e.customer_name}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:e.product_name}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:(0,g.fK)(e.price)}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:e.order_status}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:(0,g.a)(e.created_at)}),(0,a.jsxs)("td",{className:"py-1.5 px-3",children:[(0,a.jsx)("button",{className:"inline me-2 fas fa-comment-dots p-1.5 rounded transition-all bg-blue-100 text-blue-500 hover:bg-blue-500 hover:text-white cursor-pointer ring-custom ring-blue-400",onClick:()=>{H({qna:e.review_qna,feedback:e.feedback}),$()}}),e.qna.length>0&&(0,a.jsx)("button",{className:"inline me-2 far fa-circle-question p-1.5 rounded transition-all bg-accent-dimmed accent hover:bg-accent hover:text-white cursor-pointer ring-accent",onClick:()=>{K(e.qna),V()},disabled:!(e.qna&&e.qna.length>0)})]})]},s)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"text-red-500 text-center py-2 font-semibold",children:"No entries to show!"})})})]}),F&&(0,a.jsx)("div",{className:"text-red-500 text-center pt-2 min-h-96",children:"Something went wrong"})]})]}),(0,a.jsx)(c.Z,{itemsPerPage:w,setItemsPerPage:k,currentPage:S,setCurrentPage:P,totalEntries:O,totalPages:_})]})})}),(0,a.jsx)(m.R,{isOpen:J,onClose:W,size:"5xl",backdrop:"none",scrollBehavior:"inside",children:(0,a.jsxs)(h.A,{children:[(0,a.jsx)(u.k,{children:(0,a.jsx)("p",{children:"Question/Answers"})}),(0,a.jsx)(p.I,{children:G&&G.length>0?(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:G.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded p-4 shadow-sm bg-gray-50",children:[(0,a.jsx)("div",{className:"font-semibold",children:"Question:"}),(0,a.jsx)("p",{children:e.question}),(0,a.jsx)("div",{className:"font-semibold mt-2",children:"Answer:"}),(0,a.jsxs)("p",{children:[" ",Array.isArray(e.answer)?e.answer.join(", "):e.answer]})]},s))}):(0,a.jsx)("p",{children:"No questions available."})}),(0,a.jsx)(j.R,{children:(0,a.jsx)(o.A,{color:"danger",variant:"light",onPress:W,children:"Close"})})]})}),(0,a.jsx)(m.R,{isOpen:Y,onClose:ee,size:"5xl",backdrop:"none",scrollBehavior:"inside",children:(0,a.jsxs)(h.A,{children:[(0,a.jsx)(u.k,{children:(0,a.jsx)("p",{children:"Customer Feedback"})}),(0,a.jsxs)(p.I,{className:"px-2 sm:px-8",children:[(0,a.jsxs)("p",{className:"py-0.5 px-1.5 rounded border bg-gray-50 font-medium text-lg",children:["Feedback: ",M.feedback||"No Feedback Provided"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("p",{className:"mt-1 px-1.5 font-medium text-lg",children:"Feedback QNA:"}),(0,a.jsx)("div",{className:"rounded border p-3",children:(null==M?void 0:M.qna)&&(null==M?void 0:null===(e=M.qna)||void 0===e?void 0:e.length)>0?(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:M.qna.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded p-4 shadow-sm bg-gray-50",children:[(0,a.jsx)("div",{className:"font-semibold",children:"Question:"}),(0,a.jsx)("p",{children:e.question}),(0,a.jsx)("div",{className:"font-semibold mt-2",children:"Answer:"}),(0,a.jsx)("p",{children:e.answers.join(", ")})]},s))}):(0,a.jsx)("p",{children:"No Feedback QNA available."})})]})]}),(0,a.jsx)(j.R,{children:(0,a.jsx)(o.A,{color:"danger",variant:"light",onPress:ee,children:"Close"})})]})})]})}}},function(e){e.O(0,[7242,934,3628,9975,2888,9774,179],function(){return e(e.s=20779)}),_N_E=e.O()}]);