(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[333],{7353:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/warehouse/shipment/[shipmentID]",function(){return t(7647)}])},8344:function(e,s,t){"use strict";var a=t(5893);t(7294),s.Z=e=>{let{url:s}=e;return(0,a.jsx)("div",{className:"border",children:(0,a.jsx)("iframe",{src:s,className:"w-full h-[450px]"})})}},7647:function(e,s,t){"use strict";t.r(s);var a=t(5893),r=t(1163),i=t(7294),n=t(373),d=t(9134),l=t(7957),o=t(9469),c=t(9621),p=t(1680),m=t(199),x=t(7740),h=t(6597),u=t(6476),f=t(9412),j=t(8344),g=t(9008),b=t.n(g);s.default=()=>{let e="https://buybackservice.unicornstore.in",s=(0,r.useRouter)(),[t,g]=(0,i.useState)([]),{shipmentID:N}=s.query,[y,w]=(0,i.useState)(!0),[v,_]=(0,i.useState)(null),[S,D]=(0,i.useState)(""),[E,k]=(0,i.useState)(!1),{isOpen:C,onOpen:P,onOpenChange:W}=(0,l.q)(),[I,A]=(0,i.useState)({}),O=async()=>{try{w(!0);let s=await fetch("".concat(e,"/get-shipment/").concat(N,"?page=1&per_page=10&sort_desc=false"));if(!s.ok)throw Error("Could not get shipment data");let t=await s.json();if("success"===t.status)g(t.shipment_data);else throw Error(t.message)}catch(e){d.Am.error(e.message,{toastId:"getShipmentError"}),_(e.message)}finally{w(!1)}};(0,i.useEffect)(()=>{s.isReady&&O()},[s,s.isReady]);let F=async(s,t)=>{try{let t=await fetch("".concat(e,"/orders-data-wipe?order_id=").concat(s,"&shipment_id=").concat(N,"&datawipe_certificate=").concat(S),{method:"PUT"});if(!t.ok)throw Error("Could not update data wipe status");let a=await t.json();if("success"===a.status)d.Am.success("Data wipe status updated successfully",{toastId:"updateDataWipeSuccess"}),O();else throw Error(a.message)}catch(e){d.Am.error(e.message,{toastId:"updateDataWipeError"})}finally{k(!1),D(null),A({}),t()}},R=e=>{let s=e.target.files[0];s&&"application/pdf"===s.type?(B(s),k(!0)):(d.Am.error("Please select a valid PDF file",{toastId:"selectValidPDFErrors"}),k(!1))},B=async s=>{if(!s){d.Am.error("Please select a pdf first");return}let t=new FormData;t.append("file",s);try{let s=await fetch("".concat(e,"/upload-pdf"),{method:"POST",body:t});if(!s.ok)throw Error("Could not upload pdf");let a=await s.json();if("success"!==a.status)throw Error(a.message);D(a.url)}catch(e){d.Am.error(e.message,{toastId:"uploadPdfError"})}};return y?(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(n.Z,{color:"#42c8b7",loading:y,size:40,"aria-label":"Loading Spinner","data-testid":"loader"})}):v?(0,a.jsx)("p",{children:v}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"shadow-lg rounded-lg p-6 bg-white",children:[(0,a.jsx)(b(),{children:(0,a.jsxs)("title",{children:["BuyBack - Shipment ",N]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg overflow-hidden p-2",children:[(0,a.jsxs)("h3",{className:"text-2xl font-bold",children:["Update Shipment ",(0,a.jsx)("i",{className:"fas fa-box text-lg"})]}),(0,a.jsx)("div",{className:"mb-4 mt-2",children:(0,a.jsx)(o.d,{children:(0,a.jsxs)(c.G,{"aria-label":"Shipment Data",title:"Shipment Data",classNames:{base:"border border-gray-300 rounded",trigger:"hover:bg-accent-dimmed transition-all data-[open=true]:bg-accent-dimmed px-2",content:"p-4",title:"text-xl font-semibold"},children:[(0,a.jsxs)("h2",{className:"text-lg font-medium mb-2",children:["Shipment ID:"," ",(0,a.jsx)("span",{className:"font-medium",children:t.shipment_id})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Company:"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.company})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Shipping Class:"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.shipping_class})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Status:"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.status})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Weight (kg):"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.weight_in_kg})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Pickup Location:"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.pickup_location})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Drop-off Warehouse:"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.drop_off_warehouse})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Box Dimensions:"," ",(0,a.jsxs)("span",{className:"font-semibold",children:[t.box_dimensions&&Object.values(t.box_dimensions).join(" x ")," "]})]})]})]},"1")})}),t.orders&&t.orders.length>0?(0,a.jsxs)("div",{className:"px-2",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Orders"}),(0,a.jsx)("div",{className:"border rounded",children:(0,a.jsxs)("table",{className:"min-w-full table-auto  overflow-hidden",children:[(0,a.jsx)("thead",{className:"bg-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"ID"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Brand"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Product"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Variant"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Data Wipe"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.orders.map((e,s)=>(0,a.jsxs)("tr",{className:"divide-x",children:[(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center capitalize",children:e.order_id}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center capitalize",children:e.brand}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.product_name}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.variant_name}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.order_status}),(0,a.jsx)("td",{className:"whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:0===e.data_wiped?(0,a.jsxs)("select",{name:"dataWipe",id:"dataWipe",value:e.data_wiped,onChange:()=>{A(e),P()},className:"w-full border rounded px-2 outline-none py-1.5",children:[(0,a.jsx)("option",{value:"1",children:"Wiped"}),(0,a.jsx)("option",{value:"0",children:"Not Wiped"})]}):(0,a.jsx)("span",{children:"Wiped"})})]},s))})]})})]}):(0,a.jsx)("div",{className:"flex justify-center border p-4 font-semibold text-red-500",children:"No orders to show"})]})]}),(0,a.jsx)(p.R,{isOpen:C,onOpenChange:W,backdrop:"opaque",children:(0,a.jsx)(m.A,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.k,{className:"flex flex-col gap-1",children:"Upload Data Wipe Confirmation"}),(0,a.jsxs)(h.I,{children:[(0,a.jsxs)("p",{className:"text-lg",children:["Order ID: ",null==I?void 0:I.order_id]}),(0,a.jsx)("input",{type:"file",name:"wipedCeritificate",id:"wipedCeritificate",className:"border border-gray-300 h-fit",onChange:R,accept:"application/pdf"}),(0,a.jsx)("div",{className:"".concat(E?"visible":"invisible"),children:(0,a.jsx)(j.Z,{url:S})})]}),(0,a.jsxs)(u.R,{children:[(0,a.jsx)(f.A,{color:"danger",variant:"light",className:"rounded",onPress:()=>{e(),A({})},children:"Close"}),(0,a.jsx)(f.A,{className:"bg-accent text-white rounded",onPress:()=>{F(I.order_id,e)},children:"Submit"})]})]})})})]})}},9008:function(e,s,t){e.exports=t(7828)},6476:function(e,s,t){"use strict";t.d(s,{R:function(){return o}});var a=t(8237),r=t(5607),i=t(3295),n=t(9869),d=t(5893),l=(0,r.Gp)((e,s)=>{let{as:t,children:r,className:l,...o}=e,{slots:c,classNames:p}=(0,a.v)(),m=(0,i.gy)(s);return(0,d.jsx)(t||"footer",{ref:m,className:c.footer({class:(0,n.W)(null==p?void 0:p.footer,l)}),...o,children:r})});l.displayName="NextUI.ModalFooter";var o=l}},function(e){e.O(0,[260,242,896,110,888,774,179],function(){return e(e.s=7353)}),_N_E=e.O()}]);