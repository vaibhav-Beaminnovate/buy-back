(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53],{3511:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/liquidator/auction/[auctionID]",function(){return t(6795)}])},4133:function(e,s,t){"use strict";var a=t(5893);t(7294);var r=t(4039);s.Z=e=>{let{header:s,...t}=e;return(0,a.jsx)(r.Q,{...t,header:e=>{let{state:{isEnter:t}}=e;return(0,a.jsxs)(a.Fragment,{children:[s,(0,a.jsx)("i",{className:"bi bi-chevron-down ml-auto transition-transform duration-200 ease-out flex items-center ".concat(t&&"rotate-180")})]})},className:"border-b",buttonProps:{className:e=>{let{isEnter:s}=e;return"flex items-center w-full p-4 text-left transition-all duration-200 hover:bg-accent-dimmed ".concat(s&&"bg-[#42c8b725]")}},contentProps:{className:"transition-height duration-200 ease-out"},panelProps:{className:"p-4"}})}},91:function(e,s,t){"use strict";var a=t(5893),r=t(7294);s.Z=e=>{let{closingTime:s,withColon:t}=e,[l,n]=(0,r.useState)(i(s));function i(e){let s=new Date,t=new Date(e)-s;if(t<=0)return{days:0,hours:0,minutes:0,seconds:0};let a=Math.floor(t/1e3%60).toString().padStart(2,"0"),r=Math.floor(t/6e4%60).toString().padStart(2,"0"),l=Math.floor(t/36e5%24).toString().padStart(2,"0");return{days:Math.floor(t/864e5).toString().padStart(2,"0"),hours:l,minutes:r,seconds:a}}return((0,r.useEffect)(()=>{let e=setInterval(()=>{n(i(s))},1e3);return()=>clearInterval(e)},[s]),0===l.hours&&0===l.minutes&&0===l.minutes&&0===l.seconds)?(0,a.jsx)("span",{children:"Auction Ended"}):!0===t?(0,a.jsxs)("span",{className:"grid grid-cols-4 justify-center gap-y-2 w-96",children:[(0,a.jsxs)("span",{className:"text-center",children:[l.days+":"," "]}),(0,a.jsxs)("span",{className:"text-center",children:[l.hours+":"," "]}),(0,a.jsxs)("span",{className:"text-center",children:[l.minutes+":"," "]}),(0,a.jsx)("span",{className:"text-center",children:l.seconds}),(0,a.jsx)("span",{className:"text-sm text-center text-gray-400",children:"Days"}),(0,a.jsx)("span",{className:"text-sm text-center text-gray-400",children:"Hours"}),(0,a.jsx)("span",{className:"text-sm text-center text-gray-400",children:"Minutes"}),(0,a.jsx)("span",{className:"text-sm text-center text-gray-400",children:"Seconds"})]}):(0,a.jsxs)("span",{children:[l.days>0?l.days+"d":""," ",l.days>0||l.hours>0?l.hours+"h":""," ",l.hours>0||l.minutes>0?l.minutes+"m":""," ",l.minutes>0||l.seconds>0?l.seconds+"s":""]})}},6795:function(e,s,t){"use strict";t.r(s);var a=t(5893),r=t(91),l=t(5612),n=t(5675),i=t.n(n),c=t(1163),o=t(7294),d=t(373),x=t(9134),m=t(2261),h=t(8918);t(889),t(1306);var u=t(6656),g=t(1664),p=t.n(g),j=t(5066),f=t(9008),N=t.n(f),y=t(4133),b=t(7957),w=t(9412),v=t(1680),_=t(199),S=t(7740),k=t(6597),A=t(843),C=t(2315),E=t(6476);s.default=()=>{let e="https://buybackservice.unicornstore.in",s=(0,c.useRouter)(),{auctionID:t}=s.query,[n,g]=(0,o.useState)(""),[f,I]=(0,o.useState)(""),[B,P]=(0,o.useState)({}),[D,T]=(0,o.useState)(!1),[q,M]=(0,o.useState)(!0),[F,L]=(0,o.useState)("None"),[O,Z]=(0,o.useState)(),{balance:K,setBalance:U}=(0,u.K)(),[X,z]=(0,o.useState)([]),[R,V]=(0,o.useState)(!1),[H,J]=(0,o.useState)(""),[G,Q]=(0,o.useState)([]),{isOpen:W,onOpen:Y,onOpenChange:$}=(0,b.q)(),[ee,es]=(0,o.useState)(1),[et,ea]=(0,o.useState)(""),[er,el]=(0,o.useState)(!0),en=async()=>{try{M(!0);let s=new EventSource("".concat(e,"/stream-auction/").concat(t,"/"));s.onmessage=e=>{let s=e.data.trim();try{let e=JSON.parse(s);if(console.log({parsedData:e}),e&&"success"===e.auction_data.status){if(g(e.auction_data.data),Z(e.auction_data.wager_found),z(e.wagers_data.data),!H){var t,a,r,l,n,i;console.log(null==e?void 0:null===(a=e.auction_data)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.lot_id),J(null==e?void 0:null===(l=e.auction_data)||void 0===l?void 0:null===(r=l.data)||void 0===r?void 0:r.lot_id),eo(null==e?void 0:null===(i=e.auction_data)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.lot_id)}}else throw Error("Event stream failed")}catch(e){console.error("Error parsing event data: ",e),x.Am.error(e.message,{toastId:"errorParsingEventData"})}finally{M(!1)}},s.onerror=e=>{console.error("EventSource failed: ",e),x.Am.warn("Failed to get auction updates.",{toastId:"errorMessage"})}}catch(e){console.log(e),x.Am.warn(e.message,{toastId:"errorMessage"})}},ei=async()=>{let s=localStorage.getItem("liquidator_id");try{var a;let r=await fetch("".concat(e,"/get-liquidators-highest-bid?liquidator_id=").concat(s,"&auction_id=").concat(t));if(!r.ok)throw Error("Could not get users bids");let l=await r.json();"info"===l.status?L("None"):L(null==l?void 0:null===(a=l.data)||void 0===a?void 0:a.wager_amount)}catch(e){}},ec=async()=>{},eo=async s=>{try{el(!0);let t=await fetch("".concat(e,"/get-all-lot_devices/?page=").concat(ee,"&per_page=10&lot_id=").concat(s,"&sort_desc=false"));if(!t.ok)throw Error("Could not get lot devices");let a=await t.json();Q(a.data),ea(Math.ceil(a.count)),console.log({parsedLotDevicesRes:a})}catch(e){x.Am.error(e.message)}finally{el(!1)}};(0,o.useEffect)(()=>{t&&(en(),ei(),ec())},[t,s,s.query]),(0,o.useEffect)(()=>{H&&eo(H)},[ee]);let ed=async()=>{if(1!==B[1]){T(!0),x.Am.warn("Please select the checkbox",{toastId:"warnAboutCheckbox"});return}T(!1),"false"===localStorage.getItem("completed_registration")&&(x.Am.error("Complete your registration before placing bids",{toastId:"error1"}),console.log("completed_registration = false")),V(!0);try{let s=localStorage.getItem("liquidator_id"),a=await fetch("".concat(e,"/create-wager"),{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({auction_id:t,liquidator_id:s,wager_amount:f})});if(!a.ok)throw Error("Could not create wager");let r=await a.json();"success"===r.status?(x.Am.success("Bid placed successfully",{toastId:"successBid"}),en(),ei(),ec(),U(r.remaining_balance)):"info"===r.status?x.Am.info(r.message,{toastId:"lessAmountInfo"}):"error"===r.status&&x.Am.error(r.message,{toastId:"error"})}catch(e){console.log(e.message)}V(!1)};return q?(0,a.jsx)("div",{className:"h-screen flex justify-center mt-40",children:(0,a.jsx)(d.Z,{color:"#42c8b7",loading:q,size:40,"aria-label":"Loading Spinner","data-testid":"loader"})}):q||n?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(N(),{children:(0,a.jsxs)("title",{children:["BuyBack- Auction - ",t]})}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-6 p-6",children:[(0,a.jsxs)("div",{className:"col-span-2 p-6 bg-white shadow-lg rounded-lg",children:[(0,a.jsx)(l.U,{className:"bg-white shadow-lg rounded-lg",transition:!0,transitionTimeout:250,children:(0,a.jsx)(y.Z,{header:(0,a.jsx)("div",{className:"flex justify-between items-center text-xl font-semibold text-gray-800 cursor-pointer",children:(0,a.jsx)("span",{children:n.auction_name+" Images"})}),children:(0,a.jsx)("div",{className:"w-full flex justify-center p-6",children:(0,a.jsx)(m.tq,{modules:[h.W_],spaceBetween:50,slidesPerView:1,navigation:!0,children:n.images.length>0?n.images.map((e,s)=>(0,a.jsx)(m.o5,{children:(0,a.jsx)("div",{className:"w-full flex justify-center p-6",children:(0,a.jsx)(i(),{className:"rounded-lg max-h-96 object-fit w-auto",src:e.s3_image_url,width:420,height:260,alt:"dummy image"})})},s)):(0,a.jsx)(m.o5,{children:(0,a.jsx)("div",{className:"w-full flex justify-center p-6",children:(0,a.jsx)(i(),{className:"rounded-lg max-h-40 object-contain",src:"/default.webp",width:420,height:260,alt:"dummy image"})})})})})})}),(0,a.jsx)("div",{className:"mt-6 px-6",children:(0,a.jsxs)("div",{className:"text-2xl font-bold text-accent flex justify-between items-center",children:[(0,a.jsx)("p",{children:n.auction_name}),(0,a.jsx)(w.A,{color:"success",onPress:Y,className:"text-white rounded",children:"Show Devices"})]})}),(0,a.jsxs)("div",{className:"mt-6 px-6 py-4 rounded-lg bg-gray-100",children:[(0,a.jsxs)("div",{className:"border-b-2 border-gray-200 pb-4 flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Time Left:"}),(0,a.jsx)("span",{className:"ml-10 text-4xl font-light text-gray-800",children:(0,a.jsx)(r.Z,{closingTime:n.closing_time,withColon:!0})})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-4 ml-24",children:["Ending at"," ",new Date(n.closing_time).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})]})]}),(0,a.jsx)("div",{className:"pt-4 flex flex-col",children:O?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Current Bid:"}),(0,a.jsx)("span",{className:"ml-10 text-3xl font-light text-gray-800",children:(0,j.fK)(n.current_price)})]}),(0,a.jsxs)("p",{className:"mt-2 text-gray-600 capitalize",children:["from: ",n.liquidator_name]})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Starting Bid:"}),(0,a.jsxs)("span",{className:"ml-10 text-3xl font-light text-gray-800",children:["₹",n.starting_price]})]})})}),(0,a.jsx)("div",{className:"relative py-4 grid grid-cols-3 gap-4 mt-6",children:K>0&&"closed"!==n.status?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"bg-white rounded-lg px-4 py-3 border border-[#42c8b7] focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-[#42c8b7] col-span-2 relative",children:[(0,a.jsx)("span",{className:"absolute left-4 top-1/2 transform -translate-y-1/2",children:"₹"}),(0,a.jsx)("input",{className:"outline-none px-6 w-full text-xl",type:"number",name:"bidValue",value:f,onChange:e=>{I(e.target.value)},onKeyDown:e=>{("ArrowUp"===e.key||"ArrowDown"===e.key)&&e.preventDefault()},autoComplete:"false"})]}),(0,a.jsx)("button",{className:"bg-accent text-white rounded-lg py-3 hover:bg-accent-dark transition-all",onClick:ed,children:R?(0,a.jsx)("span",{className:"inline-block w-4 h-4 border-2 border-white border-t-transparent  rounded-full animate-spin"}):"Place Bid"}),(0,a.jsx)("span",{className:"col-span-3 ".concat(D?"visible":"invisible"," text-sm text-red-500 mt-2"),children:"Please select the checkbox"}),(0,a.jsxs)("span",{className:"col-span-3 text-sm mt-4",children:["Learn more about how bidding works in our"," ",(0,a.jsx)("a",{className:"accent hover:underline",href:"/sample.pdf",target:"_blank",children:"auction bidding guide"}),"."]}),(0,a.jsxs)("label",{id:"label-agreetoTNC",className:"col-span-3 bg-gray-100 p-3 rounded-lg mt-4 flex items-start cursor-pointer custom-checkbox",children:[(0,a.jsx)("input",{type:"checkbox",name:"agreetoTNC",checked:1===B[1],onChange:()=>{P(e=>{let s={...e};return 1===s[1]?delete s[1]:s[1]=1,s})},className:"hidden"}),(0,a.jsx)("span",{className:"checkmark",children:(0,a.jsx)("svg",{viewBox:"0 0 24 24",className:"check-icon",children:(0,a.jsx)("path",{d:"M9 19l-7-7 1.41-1.41L9 16.17l14.59-14.59L24 3l-15 15z",fill:"white"})})}),(0,a.jsxs)("span",{className:"ml-4 flex flex-col",children:["I agree to pay if I win this auction",(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Additional condition"})]})]})]}):"closed"===n.status?(0,a.jsxs)("p",{className:"text-red-600 bg-red-100 border border-red-300 rounded-lg px-4 py-3 mt-4 col-span-3",children:[(0,a.jsx)("i",{className:"bi bi-exclamation-circle-fill text-xl me-2"}),"Auction Has ended, please visit home page to view more auctions."]}):(0,a.jsxs)("p",{className:"text-red-600 bg-red-100 border border-red-300 rounded-lg px-4 py-3 mt-4 col-span-3",children:[(0,a.jsx)("i",{className:"bi bi-exclamation-circle-fill text-xl me-2"}),"Your balance is insufficient. Please recharge your"," ",(0,a.jsxs)(p(),{className:"underline",href:"/liquidator/profile/wallet",children:[" ","wallet"]})," ","to place more bids."]})})]})]}),(0,a.jsxs)("div",{className:"sticky top-28 h-fit flex flex-col gap-y-4",children:[(0,a.jsxs)("div",{className:"p-6 bg-white shadow-lg rounded-lg h-fit",children:[(0,a.jsxs)("div",{className:"text-xl font-semibold text-gray-800 flex items-center space-x-2",children:[(0,a.jsx)("i",{className:"bi bi-clock"}),(0,a.jsx)("span",{children:"Timed Auction"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 w-full gap-x-2 mt-4",children:[(0,a.jsx)("span",{className:"col-span-1 text-center font-medium text-gray-600",children:"Auction ends:"}),(0,a.jsx)("span",{className:"col-span-2 text-center font-semibold text-gray-800",children:new Date(n.closing_time).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0})})]}),(0,a.jsx)("div",{className:"w-full mt-6",children:(0,a.jsx)(l.U,{className:"bg-white shadow-lg rounded-lg",transition:!0,transitionTimeout:250,children:(0,a.jsxs)(y.Z,{header:(0,a.jsx)("span",{className:"text-gray-800 font-medium",children:"Additional Fees"}),children:[(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Fees apply to the hammer price:"}),(0,a.jsx)("p",{className:"font-semibold my-2 text-gray-800",children:"Free Registration"}),(0,a.jsx)("p",{className:"text-gray-600",children:"27.6% inc VAT*"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-6",children:"*These fees include buyers premiums and internet surcharges."}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Please see the auctioneers & conditions for more information"})]})})})]}),(0,a.jsxs)("div",{className:"p-6 bg-white shadow-lg rounded-lg h-fit grid grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"Time Left:"}),(0,a.jsx)("p",{children:"My Max Bid:"}),(0,a.jsx)("p",{children:"Bids:"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:(0,a.jsx)(r.Z,{closingTime:n.closing_time})}),(0,a.jsx)("p",{children:F?(0,j.fK)(F):"-"}),(0,a.jsx)("p",{children:(null==n?void 0:n.wager_count)?null==n?void 0:n.wager_count:0})]})]}),(0,a.jsxs)("div",{className:"p-6 bg-white shadow-lg rounded-lg grid grid-cols-2 h-fit max-h-[600px] overflow-y-scroll scrollbar-hidden",children:[(0,a.jsxs)("div",{className:"text-xl font-semibold text-gray-800 flex items-center space-x-2 col-span-2 mb-5 ",children:[(0,a.jsx)("i",{className:"bi bi-cash"}),(0,a.jsx)("span",{children:"Bids Placed:"})]}),X.length>0?(0,a.jsxs)("table",{className:"col-span-2 w-full text-center border-collapse border border-gray-300",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-200 border-b border-gray-300",children:[(0,a.jsx)("th",{className:"py-2 px-4 text-gray-700",children:"User"}),(0,a.jsx)("th",{className:"py-2 px-4 text-gray-700",children:"Bid Amount"})]})}),(0,a.jsx)("tbody",{children:X.map((e,s)=>(0,a.jsxs)("tr",{className:"hover:bg-gray-100",children:[(0,a.jsx)("td",{className:"py-2 px-4 border-b border-gray-300",children:e.liquidator_name}),(0,a.jsx)("td",{className:"py-2 px-4 border-b border-gray-300",children:(0,j.fK)(e.wager_amount)})]},s))})]}):(0,a.jsx)("div",{className:"flex justify-center items-center bg-[#f5f5f5] border border-[#42c8b7] text-[#42c8b7] rounded-lg py-4 px-6 mt-4 col-span-2",children:(0,a.jsx)("p",{className:"font-semibold text-lg",children:"No Bids to Show!"})})]})]})]}),(0,a.jsx)(v.R,{isOpen:W,onOpenChange:$,size:"xl",children:(0,a.jsx)(_.A,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.k,{className:"flex flex-col gap-1",children:"Auction Devices"}),(0,a.jsxs)(k.I,{children:[(0,a.jsxs)("table",{className:"min-w-full table-auto bg-white rounded overflow-hidden shadow",children:[(0,a.jsx)("thead",{className:"bg-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-center py-2.5",children:"Index"}),(0,a.jsx)("th",{className:"text-center py-2.5",children:"Brand"}),(0,a.jsx)("th",{className:"text-center py-2.5",children:"Device"})]})}),er?(0,a.jsx)("tbody",{className:"divide-y",children:Array.from({length:10}).map((e,s)=>(0,a.jsxs)("tr",{className:"divide-x",children:[(0,a.jsx)("td",{className:"py-1.5 px-2 text-center",children:(0,a.jsx)(A.X,{className:"h-5 rounded-full"})}),(0,a.jsx)("td",{className:"py-1.5 px-2 text-center",children:(0,a.jsx)(A.X,{className:"h-5 rounded-full"})}),(0,a.jsx)("td",{className:"py-1.5 px-2 text-center",children:(0,a.jsx)(A.X,{className:"h-5 rounded-full"})})]},s))}):G&&G.length>0?(0,a.jsx)("tbody",{className:"divide-y",children:G.map((e,s)=>(0,a.jsxs)("tr",{className:"divide-x",children:[(0,a.jsx)("td",{className:"py-2.5 text-center",children:s+1}),(0,a.jsx)("td",{className:"py-2.5 text-center",children:e.name}),(0,a.jsx)("td",{className:"py-2.5 text-center",children:e.variant_name})]},s))}):(0,a.jsx)("td",{className:"w-full border py-4 text-center text-red-500 font-semibold","aria-colspan":3,colspan:3,children:"No entries to show!"})]}),et>1&&(0,a.jsx)(C.g,{showControls:!0,color:"success",total:et,page:ee,onChange:es,classNames:{cursor:"text-white",base:"mx-auto"}})]}),(0,a.jsx)(E.R,{children:(0,a.jsx)(w.A,{color:"danger",variant:"light",onPress:e,className:"rounded",children:"Close"})})]})})})]}):(0,a.jsx)("div",{className:"h-screen flex justify-center mt-40",children:(0,a.jsx)("h2",{className:"text-red-500",children:"Error: Something went wrong"})})}}},function(e){e.O(0,[260,242,630,888,774,179],function(){return e(e.s=3511)}),_N_E=e.O()}]);