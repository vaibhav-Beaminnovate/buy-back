(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[333],{7353:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/warehouse/shipment/[shipmentID]",function(){return t(5470)}])},5470:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return m}});var a=t(5893);t(1664);var r=t(1163),i=t(7294),n=t(373),d=t(9134),l=t(3053),o=e=>{let{url:s}=e;return(0,a.jsx)("div",{className:"border",children:(0,a.jsx)("iframe",{src:s,className:"w-full h-[450px]"})})},c=t(9008),p=t.n(c),m=()=>{let e="https://buybackservice.unicornstore.in",s=(0,r.useRouter)(),[t,c]=(0,i.useState)([]),{shipmentID:m}=s.query,[h,x]=(0,i.useState)(!0),[u,f]=(0,i.useState)(null),[g,j]=(0,i.useState)(null),[b,y]=(0,i.useState)(""),[N,w]=(0,i.useState)(null),[v,_]=(0,i.useState)(""),[S,E]=(0,i.useState)(!1),k=async()=>{try{x(!0);let s=await fetch("".concat(e,"/get-shipment/").concat(m,"?page=1&per_page=10&sort_desc=false"));if(!s.ok)throw Error("Could not get shipment data");let t=await s.json();if("success"===t.status)c(t.shipment_data);else throw Error(t.message)}catch(e){d.Am.error(e.message,{toastId:"getShipmentError"}),f(e.message)}finally{x(!1)}};(0,i.useEffect)(()=>{s.isReady&&k()},[s,s.isReady]);let C=async s=>{try{let t=await fetch("".concat(e,"/orders-data-wipe?order_id=").concat(s,"&shipment_id=").concat(m,"&datawipe_certificate=").concat(b),{method:"PUT"});if(!t.ok)throw Error("Could not update data wipe status");let a=await t.json();if("success"===a.status)d.Am.success("Data wipe status updated successfully",{toastId:"updateDataWipeSuccess"}),j(null),k();else throw Error(a.message)}catch(e){d.Am.error(e.message,{toastId:"updateDataWipeError"})}finally{E(!1),j(null)}},P=e=>{let s=e.target.files[0];s&&"application/pdf"===s.type?(w(s),D(s),E(!0)):(d.Am.error("Please select a valid PDF file",{toastId:"selectValidPDFErrors"}),E(!1))},D=async s=>{if(!s){d.Am.error("Please select a pdf first",{toastId:"PdfNotSelected"});return}let t=new FormData;t.append("file",s);try{let s=await fetch("".concat(e,"/upload-pdf"),{method:"POST",body:t});if(!s.ok)throw Error("Could not upload pdf");let a=await s.json();if("success"!==a.status)throw Error(a.message);y(a.url)}catch(e){d.Am.error(e.message,{toastId:"uploadPdfError"})}};return h?(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(n.Z,{color:"#42c8b7",loading:h,size:40,"aria-label":"Loading Spinner","data-testid":"loader"})}):u?(0,a.jsx)("p",{children:u}):(0,a.jsxs)("div",{className:"shadow-lg rounded-lg p-6 bg-white",children:[(0,a.jsx)(p(),{children:(0,a.jsxs)("title",{children:["BuyBack - Shipment ",m]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg overflow-hidden p-2",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-2",children:["Shipment ID:"," ",(0,a.jsx)("span",{className:"font-medium",children:t.shipment_id})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Company:"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.company})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Shipping Class:"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.shipping_class})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Status:"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.status})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Weight (kg):"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.weight_in_kg})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Pickup Location:"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.pickup_location})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Drop-off Warehouse:"," ",(0,a.jsx)("span",{className:"font-semibold",children:t.drop_off_warehouse})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Box Dimensions:"," ",(0,a.jsxs)("span",{className:"font-semibold",children:[t.box_dimensions&&Object.values(t.box_dimensions).join(" x ")," "]})]})]})]}),t.orders&&t.orders.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Orders"}),(0,a.jsx)("div",{className:"border rounded",children:(0,a.jsxs)("table",{className:"min-w-full table-auto  overflow-hidden",children:[(0,a.jsx)("thead",{className:"bg-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"ID"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Brand"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Product"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Variant"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Data Wipe"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.orders.map((e,s)=>(0,a.jsxs)("tr",{className:"divide-x hover:bg-gray-100",children:[(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center capitalize",children:e.order_id}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center capitalize",children:e.brand}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.product_name}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.variant_name}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.order_status}),(0,a.jsxs)("td",{className:"whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:[0===e.data_wiped?(0,a.jsxs)("select",{name:"dataWipe",id:"dataWipe",value:e.data_wiped,onChange:()=>{j(e.order_id)},className:"w-full border rounded px-2 outline-none py-1.5",children:[(0,a.jsx)("option",{value:"1",children:"Wiped"}),(0,a.jsx)("option",{value:"0",children:"Not Wiped"})]}):(0,a.jsx)("span",{children:"Wiped"}),g===e.order_id&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 z-50 flex justify-center items-center",children:(0,a.jsxs)("div",{className:"relative bg-white h-[600px] w-[450px] rounded-md grid grid-cols-1 gap-2 p-4 overflow-auto scrollbar-hide",children:[(0,a.jsx)("div",{className:"absolute right-2 top-2",children:(0,a.jsx)("i",{className:"bi bi-x-lg p-2 rounded flex justify-center items-center bg-red-100 text-red-500 hover:bg-red-400 hover:text-white transition",onClick:()=>j(null)})}),(0,a.jsx)("h3",{className:"text-lg text-start",children:"Upload Data Wipe Confirmation"}),(0,a.jsx)("input",{type:"file",name:"wipedCeritificate",id:"wipedCeritificate",className:"border border-gray-300 h-fit",onChange:P}),(0,a.jsx)("div",{className:"".concat(S?"visible":"invisible"),children:(0,a.jsx)(o,{url:b})}),(0,a.jsxs)("div",{className:"relative flex justify-end space-x-2",children:[(0,a.jsx)(l.A,{radius:"sm",color:"danger",variant:"light",onPress:()=>j(null),children:"Cancel"}),(0,a.jsx)(l.A,{radius:"sm",className:"bg-accent text-white",onPress:()=>C(e.order_id),children:"Submit"})]})]})})]})]},s))})]})})]}):(0,a.jsx)("div",{className:"flex justify-center border p-4 font-semibold text-red-500",children:"No orders to show"})]})]})}},9008:function(e,s,t){e.exports=t(7828)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=7353)}),_N_E=e.O()}]);