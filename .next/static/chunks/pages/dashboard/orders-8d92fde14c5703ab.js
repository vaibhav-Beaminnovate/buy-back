(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4954],{83454:function(e,t,n){"use strict";var r,s;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(77663)},94201:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/orders",function(){return n(31844)}])},12115:function(e,t,n){"use strict";var r=n(85893);n(67294),t.Z=e=>{let{itemsPerPage:t,setItemsPerPage:n,currentPage:s,setCurrentPage:a,totalEntries:c,totalPages:i}=e;return(0,r.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center pt-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("label",{htmlFor:"items",className:"text-sm",children:"Items per page:"}),(0,r.jsx)("select",{id:"items",className:"border border-gray-300 rounded-md py-1 px-2 ring-accent",value:t,onChange:e=>{n(parseInt(e.target.value,10)),a(1)},children:[15,20,25,30,35].map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 mt-3 md:mt-0",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:[t*s-t+1," to"," ",t*s<c?t*s:c," ","of ",c]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("button",{onClick:()=>a(1),disabled:1===s,className:"p-2 rounded-full ring-accent ".concat(s>1?"text-accent":"text-gray-400"),children:(0,r.jsx)("i",{className:"bi bi-chevron-bar-left text-lg"})}),(0,r.jsx)("button",{onClick:()=>a(e=>e>1?e-1:e),disabled:1===s,className:"p-2 rounded-full ring-accent ".concat(s>1?"text-accent":"text-gray-400"),children:(0,r.jsx)("i",{className:"bi bi-chevron-left text-lg"})}),(0,r.jsx)("button",{onClick:()=>a(e=>e<i?e+1:e),disabled:s===i,className:"p-2 rounded-full ring-accent ".concat(s<i?"text-accent":"text-gray-400"),children:(0,r.jsx)("i",{className:"bi bi-chevron-right text-lg"})}),(0,r.jsx)("button",{onClick:()=>a(i),disabled:s===i,className:"p-2 rounded-full ring-accent ".concat(s<i?"text-accent":"text-gray-400"),children:(0,r.jsx)("i",{className:"bi bi-chevron-bar-right text-lg"})})]})]})]})}},4625:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(67294);function s(e,t){let[n,s]=(0,r.useState)(e);return(0,r.useEffect)(()=>{let n=setTimeout(()=>{s(e)},t);return()=>{clearTimeout(n)}},[e]),n}},31844:function(e,t,n){"use strict";n.r(t);var r=n(85893),s=n(67294),a=n(4625),c=n(12115),i=n(67957),l=n(8455),o=n(49621),d=n(14930),u=n(4483),h=n(10405),m=n(44265),x=n(87740),p=n(86597),f=n(96476),g=n(32553),j=n(55961),b=n.n(j),v=n(5152),y=n.n(v),N=n(9134),w=n(9008),_=n.n(w),C=n(39840);y()(()=>n.e(8607).then(n.t.bind(n,68607,23)),{loadableGenerated:{webpack:()=>[68607]},ssr:!1}),t.default=()=>{let e="https://buybackservice.unicornstore.in",[t,j]=(0,s.useState)(""),[v,y]=(0,s.useState)([]),[w,k]=(0,s.useState)(15),[S,T]=(0,s.useState)(1),[A,O]=(0,s.useState)(1),[P,D]=(0,s.useState)(!0),[E,F]=(0,s.useState)(""),[I,q]=(0,s.useState)(""),[R,L]=(0,s.useState)(""),[z,B]=(0,s.useState)(""),[M,U]=(0,s.useState)({key:"",direction:"descending"}),[X,Z]=(0,s.useState)([]),[J,Q]=(0,s.useState)({startDate:"",endDate:""}),[G,K]=(0,s.useState)([]),[H,V]=(0,s.useState)([]),{isOpen:W,onOpen:Y,onClose:$}=(0,i.q)(),{isOpen:ee,onOpen:et,onClose:en}=(0,i.q)(),{isOpen:er,onOpen:es,onClose:ea}=(0,i.q)(),[ec,ei]=(0,s.useState)(null),[el,eo]=(0,s.useState)({cancel_note:""}),[ed,eu]=(0,s.useState)({cancel_note:""}),eh=(0,g.dQ)(),em=e=>{let{name:t,value:n}=e.target;"location"===t&&shipmentID||Q(e=>({...e,[t]:n}))},ex=async()=>{D(!0);try{let n=M.key,r="descending"===M.direction,s=await fetch("".concat(e,"/get-order-details-by-staff?staff_id=").concat(t,"&per_page=").concat(w,"&page=").concat(A,"&search=").concat(R,"&sort_by=").concat(n,"&sort_desc=").concat(r,"&from_date=").concat(J.startDate,"&to_date=").concat(J.endDate,"&status=All"),{headers:{Authorization:eh}});if(!s.ok)throw Error("Could not get order details by staff id");let a=await s.json();0===a.data.length?B("No entries found, please refine your search query"):B(""),y(a.data.length>0?a.data:[]),T(Math.ceil(a.total_count/w)),q(a.total_count),F("")}catch(e){console.error(e),F(e)}finally{setTimeout(()=>{D(!1)},300)}},ep=e=>{let t="ascending";M.key===e&&"ascending"===M.direction&&(t="descending"),U({key:e,direction:t}),O(1)};(0,s.useEffect)(()=>{j(localStorage.getItem("staff_id")),t&&ex()},[t,w,A,M]);let ef=(0,a.Z)(R,500);(0,s.useEffect)(()=>{""!==ef&&(O(1),ex())},[ef,R]);let eg=e=>(0,r.jsx)("i",{className:"fas fa-arrow-down inline-block my-auto text-xs text-gray-600 pt-0.5 ".concat("ascending"===M.direction?"rotate-180":""," transition-all ").concat(M.key!==e?"hidden":"")}),ej=e=>{let t=document.createElement("svg");b()(t,e,{format:"CODE128",width:1,height:13,margin:0});let n=t.outerHTML;return'\n      <div style="font-size: 10px; width: 25mm; height: 11mm; padding: 0; display: flex; align-items: center; justify-content: center; padding: 8px 0px 0px 0px;">\n        '.concat(n,"\n      </div>\n    ")},eb=e=>{n.e(8607).then(n.t.bind(n,68607,23)).then(t=>{(0,t.default)({printable:ej(e),type:"raw-html",style:"\n            @page { \n              size: 25mm 14mm; \n              margin: 0; \n            } \n            body { \n              display: flex; \n              align-items: center; \n              justify-content: center; \n              height: 100%; \n            } \n          "})}).catch(e=>{console.error("Failed to load printJS:",e)})},ev=async()=>{(0,C.u)("generate-orders-excel/?staff_id=".concat(t,"&show_pending=false&show_cancelled=false"),{},"Orders")},ey=e=>{try{n.e(8607).then(n.t.bind(n,68607,23)).then(t=>{(0,t.default)({printable:e,type:"raw-html",honorMarginPadding:!0,style:"\n            @page {\n              size: A4;\n              margin: 0;\n              }\n              body {\n                    margin: 0px;\n                    }\n                    div {\n                    width: 100%;\n                  } \n                  .seller-details {\n                    margin-right: 40px;\n                    }\n                    "})}).catch(e=>{console.error("Failed to load printJS:",e)})}catch(e){N.Am.error(e.message)}},eN=()=>{let e={};return el.cancel_note.trim()||(e.cancel_note="Reason for cancellation is required"),eu(e),0===Object.values(e).length},ew=async()=>{if(eN())try{let t=await fetch("".concat(e,"/cancel-order/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_id:ec.order_id,cancel_note:el.cancel_note})}),n=await t.json();n.status,ea(),eo({cancel_note:""}),eu({cancel_note:""}),N.Am.success(n.message),ex()}catch(e){N.Am.error(e.message)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_(),{children:(0,r.jsx)("title",{children:"BuyBack - Store Dashboard | Orders"})}),(0,r.jsx)("div",{className:"flex justify-center bg-gray-100 min-h-screen relative -top-28",children:(0,r.jsx)("div",{className:"container max-w-screen-xl mx-4",children:(0,r.jsxs)("div",{className:"flex flex-col justify-center space-y-2 bg-white shadow p-4 my-4 rounded-lg",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Store Dashboard | Orders"}),(0,r.jsxs)("div",{className:"relative pb-4",children:[(0,r.jsx)(l.d,{variant:"bordered",selectedKeys:X,onSelectionChange:Z,children:(0,r.jsx)(o.G,{"aria-label":"Filters",title:"Filters",startContent:(0,r.jsx)("i",{className:"fas fa-filter"}),children:(0,r.jsxs)("div",{className:"border-t grid grid-cols-2 gap-4 pt-2",children:[(0,r.jsxs)("div",{className:"relative w-full",children:[(0,r.jsx)("label",{htmlFor:"startDate",className:"mb-1",children:"Date From:"}),(0,r.jsx)("input",{type:"date",name:"startDate",id:"startDate",value:J.startDate,onChange:em,className:"px-4 py-1 border rounded w-full outline-none"})]}),(0,r.jsxs)("div",{className:"relative w-full",children:[(0,r.jsx)("label",{htmlFor:"endDate",className:"mb-1",children:"Date To:"}),(0,r.jsx)("input",{type:"date",name:"endDate",id:"endDate",value:J.endDate,onChange:em,className:"px-4 py-1 border rounded w-full outline-none"})]}),(0,r.jsx)("div",{className:"col-span-2 relative flex justify-center",children:(0,r.jsxs)(d.A,{color:"success",className:"rounded text-white ring-accent",onClick:()=>{ex(),Z("0")},children:[(0,r.jsx)("i",{className:"fa-solid fa-filter me-2"}),"Filter"]})})]})},"1")}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2 mt-3",children:[(0,r.jsx)("label",{className:"text-sm text-gray-700",htmlFor:"search-bar",children:"Search by Customer Name, Final Price or Product Name"}),(0,r.jsxs)("span",{className:"w-full flex space-x-2",children:[(0,r.jsx)("input",{type:"text",className:"border border-gray-400 py-2 px-4 rounded-md ring-accent w-full transition-all",name:"search-bar",id:"search-bar",value:R,onChange:e=>L(e.target.value),spellCheck:!1,placeholder:"Search by Customer Name, Final Price or Product Name"}),(0,r.jsxs)("div",{className:"relative space-x-2 w-fit whitespace-nowrap",children:[(0,r.jsx)(d.A,{className:"px-3 py-1 rounded bg-accent text-white cursor-pointer ring-accent h-full",onPress:()=>{L(""),U({key:"",direction:"ascending"}),Q({startDate:"",endDate:""})},children:"Clear Filters"}),(0,r.jsx)(d.A,{isIconOnly:!0,className:"rounded bg-accent text-white cursor-pointer h-full ring-accent",onPress:ev,"aria-label":"Download Excel File",children:(0,r.jsx)("i",{className:"fas fa-download "})})]})]})]}),(0,r.jsxs)("div",{className:"mt-4 rounded-md p-4 text-md overflow-auto",children:[(0,r.jsxs)("table",{className:"min-w-full whitespace-nowrap table-auto bg-white rounded overflow-hidden shadow",children:[(0,r.jsx)("thead",{className:"bg-gray-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>ep("order_detail_id"),children:["Order ID ",eg("order_detail_id")]}),(0,r.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>ep("customer_name"),children:["Customer Name ",eg("customer_name")]}),(0,r.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>ep("product_name"),children:["Product Name ",eg("product_name")]}),(0,r.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>ep("price"),children:["Final Price ",eg("price")]}),(0,r.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>ep("order_status"),children:["Order Status ",eg("order_status")]}),(0,r.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>ep("excutive"),children:["Executive Name ",eg("excutive")]}),(0,r.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>ep("created_at"),children:["Created On ",eg("created_at")]}),(0,r.jsx)("th",{className:"text-center px-3 py-2.5",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"divide-y",children:P?Array(w).fill(0).map((e,t)=>(0,r.jsx)("tr",{className:"divide-x",children:Array(8).fill(0).map((e,t)=>(0,r.jsx)("td",{className:"px-3 py-3",children:(0,r.jsx)(u.X,{className:"h-5 rounded-full"})},t))},t)):v.length>0?v.map((e,t)=>{var n;return(0,r.jsxs)("tr",{className:"text-center  text-sm md:text-base divide-x hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"py-1.5 px-3",children:e.order_id}),(0,r.jsx)("td",{className:"py-1.5 px-3",children:e.customer_name}),(0,r.jsx)("td",{className:"py-1.5 px-3",children:e.product_name}),(0,r.jsx)("td",{className:"py-1.5 px-3",children:(0,g.fK)(e.price)}),(0,r.jsx)("td",{className:"py-1.5 px-3",children:"Completed"===e.order_status?(0,r.jsxs)("select",{name:"orderStatus",id:"orderStatus",value:e.order_status,onChange:()=>{ei(e),es()},className:"w-full border rounded px-2 outline-none py-1.5",children:[(0,r.jsx)("option",{value:"Completed",children:"Completed"}),(0,r.jsx)("option",{value:"Cancelled",children:"Cancelled"})]}):(0,r.jsx)("span",{children:e.order_status})}),(0,r.jsx)("td",{className:"py-1.5 px-3",children:e.excutive}),(0,r.jsx)("td",{className:"py-1.5 px-3",children:(0,g.a)(e.created_at)}),(0,r.jsxs)("td",{className:"py-1.5 px-3",children:[(null==e?void 0:null===(n=e.images)||void 0===n?void 0:n.length)>0&&(0,r.jsx)("button",{className:"inline me-2 fas fa-image p-1.5 rounded transition-all bg-blue-100 text-blue-500 hover:bg-blue-500 hover:text-white cursor-pointer ring-custom ring-blue-400",onClick:()=>{V(e.images),et()},disabled:!(e.images&&e.images.length>0)}),e.qna.length>0&&(0,r.jsx)("button",{className:"inline me-2 far fa-circle-question p-1.5 rounded transition-all bg-accent-dimmed accent hover:bg-accent hover:text-white cursor-pointer ring-accent",onClick:()=>{K(e.qna),Y()},disabled:!(e.qna&&e.qna.length>0)}),(0,r.jsx)("button",{className:"inline me-2 fas fa-barcode p-1.5 rounded transition-all bg-sky-100 text-sky-500 hover:bg-sky-500 hover:text-white cursor-pointer ring-custom ring-sky-400",onClick:()=>eb(e.order_id)}),e.indemnity_pdf&&(0,r.jsx)("button",{className:"inline me-2 fas fa-print p-1.5 rounded transition-all bg-purple-100 text-purple-500 hover:bg-purple-500 hover:text-white cursor-pointer ring-custom ring-purple-400",onClick:()=>ey(e.indemnity_pdf)})]})]},t)}):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:7,className:"text-red-500 text-center py-2 font-semibold",children:"No entries to show!"})})})]}),E&&(0,r.jsx)("div",{className:"text-red-500 text-center pt-2 min-h-96",children:"Something went wrong"})]})]}),(0,r.jsx)(c.Z,{itemsPerPage:w,setItemsPerPage:k,currentPage:A,setCurrentPage:O,totalEntries:I,totalPages:S})]})})}),(0,r.jsx)(h.R,{isOpen:W,onClose:$,size:"5xl",backdrop:"none",scrollBehavior:"inside",children:(0,r.jsxs)(m.A,{children:[(0,r.jsx)(x.k,{children:(0,r.jsx)("p",{children:"Question/Answers"})}),(0,r.jsx)(p.I,{children:G&&G.length>0?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:G.map((e,t)=>(0,r.jsxs)("div",{className:"border rounded p-4 shadow-sm bg-slate-50",children:[(0,r.jsx)("div",{className:"font-semibold",children:"Question:"}),(0,r.jsx)("p",{children:e.question}),(0,r.jsx)("div",{className:"font-semibold mt-2",children:"Answer:"}),(0,r.jsx)("p",{children:Array.isArray(e.answer)?e.answer.join(", "):e.answer})]},t))}):(0,r.jsx)("p",{children:"No questions available."})}),(0,r.jsx)(f.R,{children:(0,r.jsx)(d.A,{color:"danger",variant:"light",onPress:$,children:"Close"})})]})}),(0,r.jsx)(h.R,{isOpen:ee,onClose:en,size:"4xl",backdrop:"none",scrollBehavior:"inside",children:(0,r.jsxs)(m.A,{children:[(0,r.jsx)(x.k,{children:(0,r.jsx)("p",{children:"Images"})}),(0,r.jsx)(p.I,{children:(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 justify-start",children:H&&H.map((e,t)=>(0,r.jsxs)("div",{className:"relative overflow-hidden rounded-lg shadow-md border pb-3 pt-1 px-4",children:[(0,r.jsx)("p",{className:"w-full text-center",children:Object.keys(e)}),(0,r.jsx)("div",{className:"my-auto",children:(0,r.jsx)("img",{src:e[Object.keys(e)[0]],alt:"Product Image",className:"object-contain object-center w-48 h-48 mx-auto"})})]},t))})}),(0,r.jsx)(f.R,{children:(0,r.jsx)(d.A,{color:"danger",variant:"light",onPress:en,children:"Close"})})]})}),(0,r.jsx)(h.R,{isOpen:er,scrollBehavior:"inside",children:(0,r.jsxs)(m.A,{children:[(0,r.jsx)(x.k,{children:(0,r.jsx)("p",{children:"Cancel Order"})}),(0,r.jsx)(p.I,{children:(0,r.jsx)("form",{className:"grid",onSubmit:e=>{e.preventDefault(),ew()},children:(0,r.jsxs)("div",{className:"relative w-full",children:[(0,r.jsx)("label",{htmlFor:"cancel_note",className:"mb-1",children:"Reason for cancellation"}),(0,r.jsx)("textarea",{rows:"4",name:"cancel_note",id:"cancel_note",className:"border rounded px-3 py-1 ring-accent w-full ".concat(ed.cancel_note?"border-red-300":""),value:el.cancel_note,onChange:e=>{let{name:t,value:n}=e.target;eo({[t]:n}),"cancel_note"===t&&(n.trim()?eu({cancel_note:""}):eu({cancel_note:"Reason for cancellation is required"}))}}),ed.cancel_note&&(0,r.jsx)("span",{className:"text-red-500 text-sm",children:ed.cancel_note})]})})}),(0,r.jsxs)(f.R,{children:[(0,r.jsx)(d.A,{color:"danger",variant:"light",onPress:ea,children:"Close"}),(0,r.jsx)(d.A,{color:"success",onPress:ew,className:"text-white",children:"Submit"})]})]})})]})}},39840:function(e,t,n){"use strict";n.d(t,{u:function(){return a}});var r=n(9134),s=n(83454);async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{var a,c;let r=localStorage.getItem("token");String(s.env.NEXT_PUBLIC_CUSTOMER_ID);let i=await fetch("".concat("https://buybackservice.unicornstore.in","/").concat(e),{...t,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r),...null!==(a=null==t?void 0:t.headers)&&void 0!==a?a:void 0}});if(!i.ok)throw Error("Something went wrong ".concat(i.status));if(""===n){let e=await i.json();if("success"!==e.status)throw Error(null!==(c=null==e?void 0:e.message)&&void 0!==c?c:"Something went wrong (status !=='success' and no message)");return e}{let e=await i.blob(),t=window.URL.createObjectURL(e),r=document.createElement("a");return r.href=t,r.setAttribute("download",n),document.body.appendChild(r),r.click(),r.remove(),null}}catch(e){r.Am.error(e.message)}}},77663:function(e){!function(){var t={229:function(e){var t,n,r,s=e.exports={};function a(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{n="function"==typeof clearTimeout?clearTimeout:c}catch(e){n=c}}();var l=[],o=!1,d=-1;function u(){o&&r&&(o=!1,r.length?l=r.concat(l):d=-1,l.length&&h())}function h(){if(!o){var e=i(u);o=!0;for(var t=l.length;t;){for(r=l,l=[];++d<t;)r&&r[d].run();d=-1,t=l.length}r=null,o=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===c||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function x(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new m(e,t)),1!==l.length||o||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=x,s.addListener=x,s.once=x,s.off=x,s.removeListener=x,s.removeAllListeners=x,s.emit=x,s.prependListener=x,s.prependOnceListener=x,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var a=n[e]={exports:{}},c=!0;try{t[e](a,a.exports,r),c=!1}finally{c&&delete n[e]}return a.exports}r.ab="//";var s=r(229);e.exports=s}()}},function(e){e.O(0,[7242,934,3628,9975,2888,9774,179],function(){return e(e.s=94201)}),_N_E=e.O()}]);