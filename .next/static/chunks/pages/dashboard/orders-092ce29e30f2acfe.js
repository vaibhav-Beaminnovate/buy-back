(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4954],{94201:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/orders",function(){return s(31844)}])},12115:function(e,t,s){"use strict";var a=s(85893);s(67294),t.Z=e=>{let{itemsPerPage:t,setItemsPerPage:s,currentPage:n,setCurrentPage:r,totalEntries:l,totalPages:c}=e;return(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("label",{htmlFor:"items",className:"text-sm",children:"Items per page:"}),(0,a.jsx)("select",{id:"items",className:"border border-gray-300 rounded-md py-1 px-2 ring-accent",value:t,onChange:e=>{s(parseInt(e.target.value,10)),r(1)},children:[15,20,25,30,35].map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-3 md:mt-0",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:[t*n-t+1," to"," ",t*n<l?t*n:l," ","of ",l]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("button",{onClick:()=>r(1),disabled:1===n,className:"p-2 rounded-full ring-accent ".concat(n>1?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-bar-left text-lg"})}),(0,a.jsx)("button",{onClick:()=>r(e=>e>1?e-1:e),disabled:1===n,className:"p-2 rounded-full ring-accent ".concat(n>1?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-left text-lg"})}),(0,a.jsx)("button",{onClick:()=>r(e=>e<c?e+1:e),disabled:n===c,className:"p-2 rounded-full ring-accent ".concat(n<c?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-right text-lg"})}),(0,a.jsx)("button",{onClick:()=>r(c),disabled:n===c,className:"p-2 rounded-full ring-accent ".concat(n<c?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-bar-right text-lg"})})]})]})]})}},4625:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(67294);function n(e,t){let[s,n]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let s=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(s)}},[e,t]),s}},31844:function(e,t,s){"use strict";s.r(t);var a=s(85893),n=s(67294),r=s(4625),l=s(12115),c=s(67957),i=s(8455),o=s(49621),d=s(14930),x=s(4483),m=s(10405),h=s(44265),u=s(87740),p=s(86597),g=s(96476),j=s(32553),f=s(55961),b=s.n(f),y=s(5152),N=s.n(y),v=s(9134),w=s(9008),_=s.n(w);N()(()=>s.e(8607).then(s.t.bind(s,68607,23)),{loadableGenerated:{webpack:()=>[68607]},ssr:!1}),t.default=()=>{let e="https://buybackservice.unicornstore.in",[t,f]=(0,n.useState)(""),[y,N]=(0,n.useState)([]),[w,C]=(0,n.useState)(null),[k,S]=(0,n.useState)(15),[A,O]=(0,n.useState)(1),[D,P]=(0,n.useState)(1),[E,F]=(0,n.useState)(!0),[q,I]=(0,n.useState)(""),[R,T]=(0,n.useState)(""),[z,B]=(0,n.useState)(""),[L,U]=(0,n.useState)(""),[Z,J]=(0,n.useState)({key:"",direction:"ascending"}),[M,Q]=(0,n.useState)([]),[X,G]=(0,n.useState)({startDate:"",endDate:""}),[K,H]=(0,n.useState)([]),[V,W]=(0,n.useState)([]),{isOpen:Y,onOpen:$,onClose:ee}=(0,c.q)(),{isOpen:et,onOpen:es,onClose:ea}=(0,c.q)(),{isOpen:en,onOpen:er,onClose:el}=(0,c.q)(),[ec,ei]=(0,n.useState)(null),[eo,ed]=(0,n.useState)({cancel_note:""}),[ex,em]=(0,n.useState)({cancel_note:""}),eh=(0,j.dQ)(),eu=e=>{let{name:t,value:s}=e.target;"location"===t&&shipmentID||G(e=>({...e,[t]:s}))},ep=async()=>{F(!0);try{let s=Z.key,a="descending"===Z.direction,n=await fetch("".concat(e,"/get-order-details-by-staff?staff_id=").concat(t,"&per_page=").concat(k,"&page=").concat(D,"&search=").concat(z,"&sort_by=").concat(s,"&sort_desc=").concat(a,"&from_date=").concat(X.startDate,"&to_date=").concat(X.endDate,"&status=All"),{headers:{Authorization:eh}});if(!n.ok)throw Error("Could not get order details by staff id");let r=await n.json();0===r.data.length?U("No entries found, please refine your search query"):U(""),N(r.data.length>0?r.data:[]),O(Math.ceil(r.total_count/k)),T(r.total_count),I("")}catch(e){console.log(e),I(e)}finally{setTimeout(()=>{F(!1)},300)}},eg=e=>{let t="ascending";Z.key===e&&"ascending"===Z.direction&&(t="descending"),J({key:e,direction:t}),P(1)};(0,n.useEffect)(()=>{f(localStorage.getItem("staff_id")),t&&ep()},[t,k,D,Z]);let ej=(0,r.Z)(z,500);(0,n.useEffect)(()=>{""!==ej&&(P(1),ep())},[ej,z]);let ef=e=>Z.key!==e?null:"ascending"===Z.direction?(0,a.jsx)("i",{className:"fas fa-arrow-up"}):(0,a.jsx)("i",{className:"fas fa-arrow-down"}),eb=e=>{let t=document.createElement("svg");b()(t,e,{format:"CODE128",width:1,height:20,margin:0});let s=t.querySelector("text");s&&s.remove();let a=document.createElementNS("http://www.w3.org/2000/svg","text");a.setAttribute("style","font: 8px monospace; fill: black; line-height: 0.5em"),a.setAttribute("text-anchor","middle"),a.setAttribute("x","35"),a.setAttribute("y",35),a.textContent="OID: ".concat(e),t.appendChild(a);let n=t.outerHTML;return'\n      <div style="font-size: 10px; width: 25mm; height: 11mm; padding: 0; display: flex; align-items: center; justify-content: center; padding: 8px 0px 0px 0px;">\n        '.concat(n,"\n      </div>\n    ")},ey=e=>{s.e(8607).then(s.t.bind(s,68607,23)).then(t=>{(0,t.default)({printable:eb(e),type:"raw-html",style:"\n            @page { \n              size: 25mm 14mm; \n              margin: 0; \n            } \n            body { \n              display: flex; \n              align-items: center; \n              justify-content: center; \n              height: 100%; \n            } \n          "})}).catch(e=>{console.error("Failed to load printJS:",e)})},eN=async()=>{try{let s=await fetch("".concat(e,"/generate-orders-excel/?staff_id=").concat(t,"&show_pending=false&show_cancelled=false"));if(!s.ok)throw Error("Could not download excel");let a=await s.blob(),n=window.URL.createObjectURL(a),r=document.createElement("a");r.href=n,r.setAttribute("download","Orders.xlsx"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}catch(e){v.Am.error(e.message)}},ev=e=>{try{s.e(8607).then(s.t.bind(s,68607,23)).then(t=>{(0,t.default)({printable:e,type:"raw-html",honorMarginPadding:!0,style:"\n            @page {\n              size: A4;\n              margin: 0;\n              }\n              body {\n                    margin: 0px;\n                    }\n                    div {\n                    width: 100%;\n                  } \n                  .seller-details {\n                    margin-right: 40px;\n                    }\n                    "})}).catch(e=>{console.error("Failed to load printJS:",e)})}catch(e){v.Am.error(e.message)}},ew=()=>{let e={};return eo.cancel_note.trim()||(e.cancel_note="Reason for cancellation is required"),em(e),0===Object.values(e).length},e_=async()=>{if(ew()){console.log({cancelOrderFormData:eo});try{let t=await fetch("".concat(e,"/cancel-order/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_id:ec.order_id,cancel_note:eo.cancel_note})}),s=await t.json();s.status,el(),ed({cancel_note:""}),em({cancel_note:""}),v.Am.success(s.message)}catch(e){v.Am.error(e.message)}}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_(),{children:(0,a.jsx)("title",{children:"BuyBack - Store Dashboard | Orders"})}),(0,a.jsx)("div",{className:"flex justify-center bg-gray-100 min-h-screen relative -top-28",children:(0,a.jsx)("div",{className:"container max-w-screen-xl mx-4",children:(0,a.jsxs)("div",{className:"flex flex-col justify-center space-y-2 bg-white shadow p-4 my-4 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Store Dashboard | Orders"}),(0,a.jsxs)("div",{className:"relative pb-4",children:[(0,a.jsx)(i.d,{variant:"bordered",selectedKeys:M,onSelectionChange:Q,children:(0,a.jsx)(o.G,{"aria-label":"Filters",title:"Filters",startContent:(0,a.jsx)("i",{className:"fas fa-filter"}),children:(0,a.jsxs)("div",{className:"border-t grid grid-cols-2 gap-4 pt-2",children:[(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("label",{htmlFor:"startDate",className:"mb-1",children:"Date From:"}),(0,a.jsx)("input",{type:"date",name:"startDate",id:"startDate",value:X.startDate,onChange:eu,className:"px-4 py-1 border rounded w-full outline-none"})]}),(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("label",{htmlFor:"endDate",className:"mb-1",children:"Date To:"}),(0,a.jsx)("input",{type:"date",name:"endDate",id:"endDate",value:X.endDate,onChange:eu,className:"px-4 py-1 border rounded w-full outline-none"})]}),(0,a.jsx)("div",{className:"col-span-2 relative flex justify-center",children:(0,a.jsxs)(d.A,{color:"success",className:"rounded text-white ring-accent",onClick:()=>{ep(),Q("0")},children:[(0,a.jsx)("i",{className:"fa-solid fa-filter me-2"}),"Filter"]})})]})},"1")}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2 mt-3",children:[(0,a.jsx)("label",{className:"text-sm text-gray-700",htmlFor:"search-bar",children:"Search by Customer Name, Final Price or Product Name"}),(0,a.jsxs)("span",{className:"w-full flex space-x-2",children:[(0,a.jsx)("input",{type:"text",className:"border border-gray-400 py-2 px-4 rounded-md ring-accent w-full transition-all",name:"search-bar",id:"search-bar",value:z,onChange:e=>B(e.target.value),spellCheck:!1,placeholder:"Search by Customer Name, Final Price or Product Name"}),(0,a.jsxs)("div",{className:"relative space-x-2 w-fit whitespace-nowrap",children:[(0,a.jsx)(d.A,{className:"px-3 py-1 rounded bg-accent text-white cursor-pointer ring-accent h-full",onPress:()=>{B(""),J({key:"",direction:"ascending"}),G({startDate:"",endDate:""})},children:"Clear Filters"}),(0,a.jsx)(d.A,{isIconOnly:!0,className:"rounded bg-accent text-white cursor-pointer h-full ring-accent",onPress:eN,"aria-label":"Download Excel File",children:(0,a.jsx)("i",{className:"fas fa-download "})})]})]})]}),(0,a.jsxs)("div",{className:"mt-4 rounded-md p-4 text-md overflow-auto",children:[(0,a.jsxs)("table",{className:"min-w-full whitespace-nowrap table-auto bg-white rounded overflow-hidden shadow",children:[(0,a.jsx)("thead",{className:"bg-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>eg("order_detail_id"),children:["Order ID ",ef("order_detail_id")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>eg("customer_name"),children:["Customer Name ",ef("customer_name")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>eg("product_name"),children:["Product Name ",ef("product_name")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>eg("price"),children:["Final Price ",ef("price")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>eg("order_status"),children:["Order Status ",ef("order_status")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>eg("excutive"),children:["Executive Name ",ef("excutive")]}),(0,a.jsxs)("th",{className:"text-center cursor-pointer px-3 py-2.5",onClick:()=>eg("created_at"),children:["Created On ",ef("created_at")]}),(0,a.jsx)("th",{className:"text-center px-3 py-2.5",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y",children:E?Array(k).fill(0).map((e,t)=>(0,a.jsx)("tr",{className:"divide-x",children:Array(8).fill(0).map((e,t)=>(0,a.jsx)("td",{className:"px-3 py-3",children:(0,a.jsx)(x.X,{className:"h-5 rounded-full"})},t))},t)):y.length>0?y.map((e,t)=>{var s;return(0,a.jsxs)("tr",{className:"text-center  text-sm md:text-base divide-x hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-1.5 px-3",children:e.order_id}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:e.customer_name}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:e.product_name}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:(0,j.fK)(e.price)}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:"Completed"===e.order_status?(0,a.jsxs)("select",{name:"orderStatus",id:"orderStatus",value:e.order_status,onChange:()=>{ei(e),er()},className:"w-full border rounded px-2 outline-none py-1.5",children:[(0,a.jsx)("option",{value:"Completed",children:"Completed"}),(0,a.jsx)("option",{value:"Cancelled",children:"Cancelled"})]}):(0,a.jsx)("span",{children:e.order_status})}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:e.excutive}),(0,a.jsx)("td",{className:"py-1.5 px-3",children:(0,j.a)(e.created_at)}),(0,a.jsxs)("td",{className:"py-1.5 px-3",children:[(null==e?void 0:null===(s=e.images)||void 0===s?void 0:s.length)>0&&(0,a.jsx)("button",{className:"inline me-2 fas fa-image p-1.5 rounded transition-all bg-blue-100 text-blue-500 hover:bg-blue-500 hover:text-white cursor-pointer ring-custom ring-blue-400",onClick:()=>{W(e.images),es()},disabled:!(e.images&&e.images.length>0)}),e.qna.length>0&&(0,a.jsx)("button",{className:"inline me-2 far fa-circle-question p-1.5 rounded transition-all bg-accent-dimmed accent hover:bg-accent hover:text-white cursor-pointer ring-accent",onClick:()=>{H(e.qna),$()},disabled:!(e.qna&&e.qna.length>0)}),(0,a.jsx)("button",{className:"inline me-2 fas fa-barcode p-1.5 rounded transition-all bg-sky-100 text-sky-500 hover:bg-sky-500 hover:text-white cursor-pointer ring-custom ring-sky-400",onClick:()=>ey(e.order_id)}),e.indemnity_pdf&&(0,a.jsx)("button",{className:"inline me-2 fas fa-print p-1.5 rounded transition-all bg-purple-100 text-purple-500 hover:bg-purple-500 hover:text-white cursor-pointer ring-custom ring-purple-400",onClick:()=>ev(e.indemnity_pdf)})]})]},t)}):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"text-red-500 text-center py-2 font-semibold",children:"No entries to show!"})})})]}),q&&(0,a.jsx)("div",{className:"text-red-500 text-center pt-2 min-h-96",children:"Something went wrong"})]})]}),(0,a.jsx)(l.Z,{itemsPerPage:k,setItemsPerPage:S,currentPage:D,setCurrentPage:P,totalEntries:R,totalPages:A})]})})}),(0,a.jsx)(m.R,{isOpen:Y,onClose:ee,size:"5xl",backdrop:"none",scrollBehavior:"inside",children:(0,a.jsxs)(h.A,{children:[(0,a.jsx)(u.k,{children:(0,a.jsx)("p",{children:"Question/Answers"})}),(0,a.jsx)(p.I,{children:K&&K.length>0?(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:K.map((e,t)=>(0,a.jsxs)("div",{className:"border rounded p-4 shadow-sm bg-gray-50",children:[(0,a.jsx)("div",{className:"font-semibold",children:"Question:"}),(0,a.jsx)("p",{children:e.question}),(0,a.jsx)("div",{className:"font-semibold mt-2",children:"Answer:"}),(0,a.jsx)("p",{children:Array.isArray(e.answer)?e.answer.join(", "):e.answer})]},t))}):(0,a.jsx)("p",{children:"No questions available."})}),(0,a.jsx)(g.R,{children:(0,a.jsx)(d.A,{color:"danger",variant:"light",onPress:ee,children:"Close"})})]})}),(0,a.jsx)(m.R,{isOpen:et,onClose:ea,size:"4xl",backdrop:"none",scrollBehavior:"inside",children:(0,a.jsxs)(h.A,{children:[(0,a.jsx)(u.k,{children:(0,a.jsx)("p",{children:"Images"})}),(0,a.jsx)(p.I,{children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 justify-start",children:V&&V.map((e,t)=>(0,a.jsxs)("div",{className:"relative overflow-hidden rounded-lg shadow-md border pb-3 pt-1 px-4",children:[(0,a.jsx)("p",{className:"w-full text-center",children:Object.keys(e)}),(0,a.jsx)("div",{className:"my-auto",children:(0,a.jsx)("img",{src:e[Object.keys(e)[0]],alt:"Product Image",className:"object-contain object-center w-48 h-48 mx-auto"})})]},t))})}),(0,a.jsx)(g.R,{children:(0,a.jsx)(d.A,{color:"danger",variant:"light",onPress:ea,children:"Close"})})]})}),(0,a.jsx)(m.R,{isOpen:en,scrollBehavior:"inside",onClose:()=>console.log("closing modal"),children:(0,a.jsxs)(h.A,{children:[(0,a.jsx)(u.k,{children:(0,a.jsx)("p",{children:"Cancel Order"})}),(0,a.jsx)(p.I,{children:(0,a.jsx)("form",{className:"grid",onSubmit:e=>{e.preventDefault(),e_()},children:(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("label",{htmlFor:"cancel_note",className:"mb-1",children:"Reason for cancellation"}),(0,a.jsx)("textarea",{rows:"4",name:"cancel_note",id:"cancel_note",className:"border rounded px-3 py-1 ring-accent w-full ".concat(ex.cancel_note?"border-red-300":""),value:eo.cancel_note,onChange:e=>{let{name:t,value:s}=e.target;ed({[t]:s}),"cancel_note"===t&&(s.trim()?em({cancel_note:""}):em({cancel_note:"Reason for cancellation is required"}))}}),ex.cancel_note&&(0,a.jsx)("span",{className:"text-red-500 text-sm",children:ex.cancel_note})]})})}),(0,a.jsxs)(g.R,{children:[(0,a.jsx)(d.A,{color:"danger",variant:"light",onPress:el,children:"Close"}),(0,a.jsx)(d.A,{color:"success",onPress:e_,className:"text-white",children:"Submit"})]})]})})]})}}},function(e){e.O(0,[7242,934,3628,9975,2888,9774,179],function(){return e(e.s=94201)}),_N_E=e.O()}]);