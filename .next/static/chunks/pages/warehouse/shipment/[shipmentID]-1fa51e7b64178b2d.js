(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8333],{37353:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/warehouse/shipment/[shipmentID]",function(){return s(17647)}])},12115:function(e,t,s){"use strict";var a=s(85893);s(67294),t.Z=e=>{let{itemsPerPage:t,setItemsPerPage:s,currentPage:r,setCurrentPage:n,totalEntries:i,totalPages:c}=e;return(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("label",{htmlFor:"items",className:"text-sm",children:"Items per page:"}),(0,a.jsx)("select",{id:"items",className:"border border-gray-300 rounded-md py-1 px-2 ring-accent",value:t,onChange:e=>{s(parseInt(e.target.value,10)),n(1)},children:[15,20,25,30,35].map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-3 md:mt-0",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:[t*r-t+1," to"," ",t*r<i?t*r:i," ","of ",i]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("button",{onClick:()=>n(1),disabled:1===r,className:"p-2 rounded-full ring-accent ".concat(r>1?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-bar-left text-lg"})}),(0,a.jsx)("button",{onClick:()=>n(e=>e>1?e-1:e),disabled:1===r,className:"p-2 rounded-full ring-accent ".concat(r>1?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-left text-lg"})}),(0,a.jsx)("button",{onClick:()=>n(e=>e<c?e+1:e),disabled:r===c,className:"p-2 rounded-full ring-accent ".concat(r<c?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-right text-lg"})}),(0,a.jsx)("button",{onClick:()=>n(c),disabled:r===c,className:"p-2 rounded-full ring-accent ".concat(r<c?"text-accent":"text-gray-400"),children:(0,a.jsx)("i",{className:"bi bi-chevron-bar-right text-lg"})})]})]})]})}},98344:function(e,t,s){"use strict";var a=s(85893);s(67294),t.Z=e=>{let{url:t}=e;return(0,a.jsx)("div",{className:"border",children:(0,a.jsx)("iframe",{src:t,className:"w-full h-[450px]"})})}},17647:function(e,t,s){"use strict";s.r(t);var a=s(85893),r=s(11163),n=s(67294),i=s(9134),c=s(67957),l=s(96180),d=s(8455),o=s(49621),m=s(10405),p=s(44265),x=s(87740),h=s(86597),u=s(96476),f=s(14930),g=s(98344),j=s(9008),b=s.n(j),N=s(32553),y=s(86455),w=s.n(y),v=s(12115);t.default=()=>{let e="https://buybackservice.unicornstore.in",t=(0,r.useRouter)(),[s,j]=(0,n.useState)([]),{shipmentID:y}=t.query,[_,C]=(0,n.useState)(!0),[S,P]=(0,n.useState)(null),[k,E]=(0,n.useState)(""),[D,I]=(0,n.useState)(!1),{isOpen:A,onOpen:W,onOpenChange:O}=(0,c.q)(),[B,F]=(0,n.useState)({}),[z,R]=(0,n.useState)(15),[q,T]=(0,n.useState)(1),[Z,U]=(0,n.useState)(null),[M,V]=(0,n.useState)(null),X=(0,N.dQ)(),G=async()=>{try{C(!0);let t=await fetch("".concat(e,"/get-shipment/").concat(y,"?page=").concat(q,"&per_page=").concat(z,"&sort_desc=false"),{headers:{Authorization:X}});if(!t.ok)throw Error("Could not get shipment data");let s=await t.json();if("success"===s.status)j(s.shipment_data),V(s.total_count),U(Math.ceil(s.total_count/z));else throw Error(s.message)}catch(e){i.Am.error(e.message,{toastId:"getShipmentError"}),P(e.message)}finally{C(!1)}};(0,n.useEffect)(()=>{t.isReady&&G()},[t,t.isReady,q,z]);let L=async(t,s)=>{try{let s=localStorage.getItem("warehouse_id"),a=await fetch("".concat(e,"/orders-data-wipe?order_id=").concat(t,"&shipment_id=").concat(y,"&datawipe_certificate=").concat(k,"&warehouse_id=").concat(s),{method:"PUT",headers:{Authorization:X}});if(!a.ok)throw Error("Could not update data wipe status");let r=await a.json();if("success"===r.status)i.Am.success("Data wipe status updated successfully",{toastId:"updateDataWipeSuccess"}),G();else throw Error(r.message)}catch(e){i.Am.error(e.message,{toastId:"updateDataWipeError"})}finally{I(!1),E(null),F({}),s()}},Q=async e=>{!1===s.confirmed_delivery?w().fire({title:"Confirm Shipment Delivery",text:"Proceeding will confirm the shipment's delivery",icon:"question",showConfirmButton:!0,showCancelButton:!0,reverseButtons:!0,confirmButtonColor:"#42c8b7"}).then(t=>{t.isConfirmed&&(F(e),W())}):(W(),F(e))},H=e=>{let t=e.target.files[0];t&&"application/pdf"===t.type?(J(t),I(!0)):(i.Am.error("Please select a valid PDF file",{toastId:"selectValidPDFErrors"}),I(!1))},J=async t=>{if(!t){i.Am.error("Please select a pdf first");return}let s=new FormData;s.append("file",t);try{let t=await fetch("".concat(e,"/upload-pdf"),{method:"POST",headers:{Authorization:X},body:s});if(!t.ok)throw Error("Could not upload pdf");let a=await t.json();if("success"!==a.status)throw Error(a.message);E(a.url)}catch(e){i.Am.error(e.message,{toastId:"uploadPdfError"})}};return _?(0,a.jsx)("div",{className:"text-center mt-40",children:(0,a.jsx)(l.c,{color:"success"})}):S?(0,a.jsx)("p",{children:S}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"shadow-lg rounded-lg p-6 bg-white",children:[(0,a.jsx)(b(),{children:(0,a.jsxs)("title",{children:["BuyBack - Shipment ",y]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg overflow-hidden p-2",children:[(0,a.jsxs)("h3",{className:"text-2xl font-bold",children:["Update Shipment ",(0,a.jsx)("i",{className:"fas fa-box text-lg"})]}),(0,a.jsx)("div",{className:"mb-4 mt-2",children:(0,a.jsx)(d.d,{children:(0,a.jsxs)(o.G,{"aria-label":"Shipment Data",title:"Shipment Data",classNames:{base:"border border-gray-300 rounded",trigger:"hover:bg-accent-dimmed transition-all data-[open=true]:bg-accent-dimmed px-2",content:"p-4",title:"text-xl font-semibold"},children:[(0,a.jsxs)("h2",{className:"text-lg font-medium mb-2",children:["Shipment ID:"," ",(0,a.jsx)("span",{className:"font-medium",children:s.shipment_id})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Company:"," ",(0,a.jsx)("span",{className:"font-semibold",children:s.company})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Shipping Class:"," ",(0,a.jsx)("span",{className:"font-semibold",children:s.shipping_class})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Status:"," ",(0,a.jsx)("span",{className:"font-semibold",children:s.status})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Weight (kg):"," ",(0,a.jsx)("span",{className:"font-semibold",children:s.weight_in_kg})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Pickup Location:"," ",(0,a.jsx)("span",{className:"font-semibold",children:s.pickup_location})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Drop-off Warehouse:"," ",(0,a.jsx)("span",{className:"font-semibold",children:s.drop_off_warehouse})]}),(0,a.jsxs)("p",{className:"px-3 py-1 border rounded hover:bg-gray-100 transition-all",children:["Box Dimensions:"," ",(0,a.jsxs)("span",{className:"font-semibold",children:[s.box_dimensions&&Object.values(s.box_dimensions).join(" x ")," "]})]})]})]},"1")})}),s.orders&&s.orders.length>0?(0,a.jsxs)("div",{className:"px-2",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Orders"}),(0,a.jsx)("div",{className:"border rounded",children:(0,a.jsxs)("table",{className:"min-w-full table-auto  overflow-hidden",children:[(0,a.jsx)("thead",{className:"bg-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"ID"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Brand"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Product"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Variant"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Old IMEI"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Customer Code"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Status"}),(0,a.jsx)("th",{className:"px-4 py-2 text-sm font-semibold uppercase text-center",children:"Data Wipe"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:s.orders.map((e,t)=>(0,a.jsxs)("tr",{className:"divide-x",children:[(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center capitalize",children:e.order_id}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center capitalize",children:e.brand}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.product_name}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.variant_name}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.old_imei}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.customer_code||"-"}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:e.order_status}),(0,a.jsx)("td",{className:"whitespace-nowrap text-sm font-medium text-gray-900 text-center",children:0===e.data_wiped?(0,a.jsxs)("select",{name:"dataWipe",id:"dataWipe",value:e.data_wiped,onChange:()=>{Q(e)},className:"w-full border rounded px-2 outline-none py-1.5",children:[(0,a.jsx)("option",{value:"1",children:"Wiped"}),(0,a.jsx)("option",{value:"0",children:"Not Wiped"})]}):(0,a.jsx)("span",{children:"Wiped"})})]},t))})]})}),(0,a.jsx)(v.Z,{itemsPerPage:z,setItemsPerPage:R,currentPage:q,setCurrentPage:T,totalEntries:M,totalPages:Z})]}):(0,a.jsx)("div",{className:"flex justify-center border p-4 font-semibold text-red-500",children:"No orders to show"})]})]}),(0,a.jsx)(m.R,{isOpen:A,onOpenChange:O,backdrop:"opaque",children:(0,a.jsx)(p.A,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.k,{className:"flex flex-col gap-1",children:"Upload Data Wipe Confirmation"}),(0,a.jsxs)(h.I,{children:[(0,a.jsxs)("p",{className:"text-lg",children:["Order ID: ",null==B?void 0:B.order_id]}),(0,a.jsx)("input",{type:"file",name:"wipedCeritificate",id:"wipedCeritificate",className:"border border-gray-300 h-fit",onChange:H,accept:"application/pdf"}),(0,a.jsx)("div",{className:"".concat(D?"visible":"invisible"),children:(0,a.jsx)(g.Z,{url:k})})]}),(0,a.jsxs)(u.R,{children:[(0,a.jsx)(f.A,{color:"danger",variant:"light",className:"rounded",onPress:()=>{e(),F({})},children:"Close"}),(0,a.jsx)(f.A,{className:"bg-accent text-white rounded",onPress:()=>{L(B.order_id,e)},children:"Submit"})]})]})})})]})}}},function(e){e.O(0,[8166,7242,934,3628,2888,9774,179],function(){return e(e.s=37353)}),_N_E=e.O()}]);